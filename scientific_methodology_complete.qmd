---
title: "Scientific Analysis of Educational Equity Claims"
subtitle: "When Ideology Masquerades as Scientific Inquiry"
bibliography: manual-refs.bib
format:
  html:
    include-after-body: 
      - text: |
         <script type="text/javascript" src="reference-backlinks.js"></script>
    css: 
      - swart-20250630.css
      # - this-doc-only.css
    page-layout: full
    fig-width: 12
    fig-height: 10
    fig-dpi: 300
    df-print: paged
    code-overflow: wrap
    toc: true
    citeproc: true
    link-citations: true
  typst:
    fig-width: 12
    fig-height: 10
    fig-dpi: 300
    margin:
      x: 1in
      y: 1in
    toc: true
    fontsize: 14pt
    mainfont: "Latin Modern Roman"
execute:
  echo: false
  message: false
  warning: false
  fig-width: 12
  fig-height: 10
---


```{r}
#| label: setup

# load libraries
library(tidyverse)

# Set global theme for consistent plots
theme_set(theme_minimal(base_size = 16) + 
          theme(
    plot.title = element_text(face = "bold", size = 24),    # adjust title size
    plot.subtitle = element_text(face = "bold", size = 20), # adjust subtitle size
    axis.title.x = element_text(face = "bold"),
    axis.title.y = element_text(face = "bold"),
    axis.text = element_text(face = "bold"),
    legend.position = "bottom",
    strip.text = element_text(face = "bold"),
    panel.spacing.x = unit(1.5, "cm"),  # Horizontal spacing only
    panel.spacing.y = unit(1.5, "cm"),   # Vertical spacing only
    plot.margin = margin(20, 20, 20, 20, "pt")
   )
  )

# Set seed for reproducibility
set.seed(42)

```




# Scientific Analysis of Educational Equity Claims


## Abstract

An earnest discussion of the methodological deficiencies in current educational equity research, demonstrating how proper scientific investigation would approach claims about group differences in academic outcomes.  The astonishing fact is that most of the important research information is never presented, or even asked for!


## The Problematic Claim

> "For example, one way for school systems to support efforts towards equity in student outcomes is to frequently examine any differences in outcomes among student subgroups (Chapter 3)."

This statement comes early in the book and contains an **unproven assumption** that group differences inherently indicate systemic bias requiring intervention.

## Distinguishing Experimental vs. Observational Research

::: {.callout-warning}
## The Government Data Problem

Most social science researchers work with datasets containing government-specified subgroups (race, ethnicity, SES categories) rather than rationally selected variables for experimental validity. This creates systematic bias in research design from the outset.

**Additional Complications:**
- **Self-designation**: Individuals choose their own racial/ethnic categories
- **Multiple categories**: Many people belong to more than one subgroup
- **Assumed homogeneity**: Massive within-group differences are ignored
:::

### Experimental Data: Ideal Scientific Approach

When researchers can control variables and assign treatments randomly.  (Or, when causal mechanisms can be simulated with observational data based on DAG analysis.


### Observational Data: Constrained but Can Still Be Scientific

When working with existing datasets (most social science research), rigorous methodology becomes even more critical.

---

## How Real Scientists Would Investigate This Claim


### Step 1: Question the Fundamental Premises


**Scientific Approach:**

- What creditable evidence supports the assumption that group differences in outcomes indicate systemic bias?  Appeals to authorities must be examined carefully.

- Under what conditions would group differences be expected even in perfectly fair systems?

- Are we conflating correlation with causation?

**Current "Equity Research" Approach:**

- Treats premise as axiomatic

- No testing of underlying assumptions

- Direct jump to data collection

- Data analysis is there only to measure the effects of the presumed causal covariance, not to verify empirically any causal assumptions made.

---

### Step 2: Form Multiple Competing Hypotheses

A proper scientific investigation would generate testable hypotheses:

**H₁: Discrimination Hypothesis**
- Differences reflect measurement bias or systemic discrimination
- *Prediction*: Differences should persist even when controlling for relevant variables

**H₂: Preparation/Effort Hypothesis** 
- Differences reflect genuine performance variations due to preparation, effort, or prior knowledge
- *Prediction*: Differences should correlate with measurable preparation factors

**H₃: Random Variation Hypothesis**
- Differences reflect normal statistical variation within acceptable bounds
- *Prediction*: Differences should fall within expected confidence intervals

**H₄: External Factors Hypothesis**
- Differences reflect cultural/family factors unrelated to school policy
- *Prediction*: School interventions should have minimal impact on these differences

---


### Step 3: Address Confounding Variables

::: {.callout-warning}
## Critical Issue: Rational Subgrouping

Current equity research fails to address whether compared groups are actually comparable.
:::

**Variables to Control For:**
- Socioeconomic status
- Family structure
- Time spent on homework
- Attendance rates
- Language spoken at home
- Prior educational preparation
- Cultural attitudes toward education

**Questions to Address:**
- Are we comparing truly comparable groups?
- What obvious explanatory variables are being ignored?
- How do we separate correlation from causation?


---

### Step 4: Establish Proper Experimental Controls

**Control Group Requirements:**
- Schools with similar demographics but different "equity" interventions
- Baseline measurements before any interventions
- Matched comparison groups

**Current Problems:**
- No control groups
- No baseline measurements
- No independent variables isolated


---

### Step 5: Account for Statistical Variation

::: {.callout-important}
## Statistical Reality

Differences will **ALWAYS** exist between any groups measured at any time, even between the same individuals tested at different times of day.
:::

**Scientific Questions:**
- What magnitude of difference is statistically significant?
- What falls within normal variation?
- Are we chasing statistical noise?
- What are the confidence intervals?

**Statistical Considerations:**
```r
# Example of proper statistical analysis
# Multiple comparisons correction needed
# Effect size calculation required  
# Confidence intervals essential
# Power analysis for sample size
```


---

### Step 6: Replication and Peer Review

**Scientific Standards:**
- Independent replication by other researchers
- Peer review of methodology
- Open data and reproducible analysis
- Pre-registration of hypotheses

**Current State:**
- Minimal independent replication
- Methodology rarely scrutinized
- Results assumed rather than tested

---


## Methodology Matrix: Experimental vs. Observational Data

### Steps Required for BOTH Experimental and Observational Studies

| Step | Experimental Data | Observational Data | 
|------|-------------------|-------------------|
| **Question Core Assumptions** | ✓ Essential | ✓ **CRITICAL** - Only way to avoid bias |
| **Multiple Competing Hypotheses** | ✓ Standard practice | ✓ **EVEN MORE Important** - Can't test assumptions directly |
| **Account for Statistical Variation** | ✓ Required | ✓ **EVEN MORE Critical** - Higher risk of noise |
| **Proper Statistical Testing** | ✓ Standard | ✓ **Enhanced Methods** - Need robustness checks |

---

### Steps That Differ Between Study Types

#### For Experimental Data (Rare in Social Science)

- **Random Assignment**: Researcher controls who gets treatment

- **Manipulation of Variables**: Can isolate causal mechanisms  

- **Direct Causation Testing**: Can establish cause-effect relationships

- **Controlled Environment**: Minimize confounding factors



#### For Observational Data (Most Social Science)

- **Quasi-Experimental Design**: Find "natural experiments"

- **Instrumental Variables**: Use external factors that affect treatment assignment

- **Regression Discontinuity**: Exploit arbitrary cutoffs in policy

- **Difference-in-Differences**: Compare changes over time between groups


---

## The Mathematical Foundations: Why Current Approaches Are Statistically Invalid

::: {.callout-critical}
## Fundamental Statistical Assumption Violation

All analytical statistics comparing groups rely on the mathematical requirement that **within-group variance should be small relative to between-group variance**. Current equity research systematically violates this assumption, rendering the statistical results mathematically meaningless.
:::

### The Mathematical Requirements for Valid Group Comparisons

For any comparative statistical analysis (ANOVA, t-tests, regression with categorical variables) to be valid:

**σ²(within) << σ²(between)**

Where:

- σ²(within) = variance within each group

- σ²(between) = variance between group means


#### When the Assumption is Violated

```{r}
#| label: variance-example

# Example: Current educational equity research
red_students <- c(300, 850, 1200, 1540, 1580)  # SAT scores within "Red" category
green_students <- c(400, 900, 1300, 1520, 1600)  # SAT scores within "Green" category

within_group_var <- var(red_students) + var(green_students)  # Massive
between_group_var <- var(c(mean(red_students), mean(green_students)))  # Small

# Create data for visualization
variance_data <- data.frame(
  Group = c("Red Students", "Green Students", "Between Groups"),
  Mean_Score = c(mean(red_students), mean(green_students), NA),
  Variance = c(var(red_students), var(green_students), between_group_var),
  SD = c(sd(red_students), sd(green_students), sqrt(between_group_var))
)

# Display results table
knitr::kable(variance_data, 
             digits = 1,
             caption = "Variance Analysis: Within-Group vs Between-Group",
             col.names = c("Group", "Mean Score", "Variance", "Standard Deviation"))

# Create distribution visualization
score_data <- data.frame(
  Score = c(red_students, green_students),
  Group = rep(c("Red", "Green"), each = 5)
)

ggplot(score_data, aes(x = Group, y = Score, fill = Group)) +
  geom_boxplot(alpha = 0.7, width = 0.5) +
  geom_jitter(width = 0.2, size = 3, alpha = 0.8) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 4, 
               fill = "white", color = "black") +
  scale_fill_manual(values = c("Red" = "#E74C3C", "Green" = "#27AE60")) +
  labs(title = "SAT Score Distributions: Massive Within-Group Variation",
       subtitle = "White diamonds show group means - note the overlap!",
       x = "Student Group", 
       y = "SAT Score",
       caption = "Within-group variance >> Between-group variance") +
  theme(legend.position = "none") +
  ylim(200, 1700)
```


### The F-Ratio Problem

In ANOVA, the F-statistic is calculated as:

**F = MS(between) / MS(within)**

When within-group variance is enormous (heterogeneous groups), the denominator inflates, making F-ratios artificially small and potentially masking real effects OR creating spurious effects depending on how the groups are constructed.


---

#### Real-World Consequences

**Educational Research:**
```{r}
#| label: heterogeneous-groups

# "Red students" category includes:
high_achieving_subgroup <- c(1400, 1450, 1500)  # High-achieving
middle_class_subgroup <- c(1200, 1350, 1400)  # Middle-class
disadvantaged_subgroup <- c(300, 400, 500)     # Low-resourced

# Create comprehensive data for visualization
all_red_students <- c(high_achieving_subgroup, middle_class_subgroup, disadvantaged_subgroup)
within_red_variance <- var(all_red_students)

# Create data frame for detailed analysis
subgroup_data <- data.frame(
  Score = c(high_achieving_subgroup, middle_class_subgroup, disadvantaged_subgroup),
  Subgroup = rep(c("High-Achieving", "Middle-Class", "Disadvantaged"), each = 3),
  Overall_Group = "Red Students"
)

# Calculate summary statistics
summary_stats <- subgroup_data %>%
  group_by(Subgroup) %>%
  summarise(
    Mean = mean(Score),
    SD = sd(Score),
    Min = min(Score),
    Max = max(Score),
    .groups = 'drop'
  ) %>%
  add_row(
    Subgroup = "Overall Red",
    Mean = mean(all_red_students),
    SD = sd(all_red_students),
    Min = min(all_red_students),
    Max = max(all_red_students)
  )

knitr::kable(summary_stats, 
             digits = 1,
             caption = "The Problem: Massive Heterogeneity Within 'Red Students'",
             col.names = c("Group", "Mean", "Std Dev", "Minimum", "Maximum"))

# Create visualization showing the problem
ggplot(subgroup_data, aes(x = Subgroup, y = Score, fill = Subgroup)) +
  geom_violin(alpha = 0.7, width = 0.8) +
  geom_jitter(width = 0.2, size = 2.5, alpha = 0.8) +
  geom_hline(yintercept = mean(all_red_students), 
             linetype = "dashed", color = "red", size = 1.2) +
  scale_fill_manual(values = c("High-Achieving" = "#27AE60", 
                              "Middle-Class" = "#F39C12", 
                              "Disadvantaged" = "#E74C3C")) +
  labs(title = "Within-Group Heterogeneity Makes Statistical Comparison Invalid",
       subtitle = "Red dashed line shows overall 'Red Student' mean - but it's meaningless!",
       x = "Subgroups Within 'Red Students'", 
       y = "SAT Score",
       caption = "Variance within 'Red Students' is larger than variance between demographic groups") +
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylim(200, 1600)
```

---

### The Women's Health Initiative Parallel

A perfect medical example of the same mathematical errors:

**WHI Study Design:**
- **"Women" category**: Ages 50-79 (heterogeneous)
- **Treatment**: Hormone therapy vs. placebo
- **Error**: Massive within-group age variance

**Mathematical Reality:**
```r
# Within "women" group
ages_50_55 <- beneficial_response   # HRT helps
ages_65_79 <- harmful_response      # HRT harmful

# Averaging across ages produces meaningless result
overall_effect <- mean(c(beneficial_response, harmful_response))
# Result: "HRT is harmful" - but this is mathematically invalid
```

**Corrected Analysis:**
```r
# Proper disaggregation by age
young_menopause <- HRT_effect[age >= 50 & age <= 55]  # Beneficial
late_menopause <- HRT_effect[age >= 65]               # Harmful

# Now within-group variance is small, between-group comparison valid
```

### Statistical Consequences of Heterogeneous Groups

#### 1. Unreliable Effect Sizes
Cohen's d and other effect size measures become meaningless:
```r
# With heterogeneous groups
d <- (mean_group1 - mean_group2) / pooled_SD
# When pooled_SD is inflated by within-group heterogeneity, 
# effect sizes are artificially deflated
```

#### 2. Invalid Confidence Intervals
```r
# Standard error calculation assumes homogeneous groups
SE <- SD / sqrt(n)
# When SD is inflated by heterogeneity, confidence intervals are wrong
```

#### 3. Type I and Type II Error Inflation
- **Type I**: Finding false differences due to arbitrary grouping
- **Type II**: Missing real differences due to noise from heterogeneous groups

### The Homogeneity Test Requirement

Before any group comparison, researchers should test:

```{r}
#| label: homogeneity-test

# Demonstrate the homogeneity test with real data
set.seed(456)

# Create homogeneous groups (valid for comparison)
group_A_homogeneous <- rnorm(30, 500, 50)  # Similar variance
group_B_homogeneous <- rnorm(30, 550, 52)  # Similar variance

# Create heterogeneous groups (invalid for comparison)
group_A_heterogeneous <- c(rnorm(10, 300, 20), rnorm(10, 500, 25), rnorm(10, 700, 30))
group_B_heterogeneous <- c(rnorm(10, 320, 22), rnorm(10, 520, 28), rnorm(10, 720, 35))

# Combine into data frame
homogeneity_data <- data.frame(
  Score = c(group_A_homogeneous, group_B_homogeneous, 
           group_A_heterogeneous, group_B_heterogeneous),
  Group = rep(c("A", "B", "A", "B"), each = 30),
  Type = rep(c("Homogeneous Groups", "Homogeneous Groups",
              "Heterogeneous Groups", "Heterogeneous Groups"), each = 30)
)

# Calculate F-statistics for both scenarios
f_test_homogeneous <- var.test(group_A_homogeneous, group_B_homogeneous)
f_test_heterogeneous <- var.test(group_A_heterogeneous, group_B_heterogeneous)

# Perform ANOVA for both
anova_homogeneous <- aov(Score ~ Group, 
                        data = filter(homogeneity_data, Type == "Homogeneous Groups"))
anova_heterogeneous <- aov(Score ~ Group, 
                          data = filter(homogeneity_data, Type == "Heterogeneous Groups"))

# Create summary table
test_results <- data.frame(
  Group_Type = c("Homogeneous", "Heterogeneous"),
  F_Variance_Test = c(f_test_homogeneous$statistic, f_test_heterogeneous$statistic),
  P_Value_Variance = c(f_test_homogeneous$p.value, f_test_heterogeneous$p.value),
  ANOVA_F = c(summary(anova_homogeneous)[[1]])
)

```




# Scientific Analysis of Educational Equity Claims


## Abstract

An earnest discussion of the methodological deficiencies in current educational equity research, demonstrating how proper scientific investigation would approach claims about group differences in academic outcomes.  The astonishing fact is that most of the important research information is never presented, or even asked for!


## The Problematic Claim

> "For example, one way for school systems to support efforts towards equity in student outcomes is to frequently examine any differences in outcomes among student subgroups (Chapter 3)."

This statement comes early in the book and contains an **unproven assumption** that group differences inherently indicate systemic bias requiring intervention.

## Distinguishing Experimental vs. Observational Research

::: {.callout-warning}
## The Government Data Problem

Most social science researchers work with datasets containing government-specified subgroups (race, ethnicity, SES categories) rather than rationally selected variables for experimental validity. This creates systematic bias in research design from the outset.

**Additional Complications:**
- **Self-designation**: Individuals choose their own racial/ethnic categories
- **Multiple categories**: Many people belong to more than one subgroup
- **Assumed homogeneity**: Massive within-group differences are ignored
:::

### Experimental Data: Ideal Scientific Approach

When researchers can control variables and assign treatments randomly.  (Or, when causal mechanisms can be simulated with observational data based on DAG analysis.


### Observational Data: Constrained but Can Still Be Scientific

When working with existing datasets (most social science research), rigorous methodology becomes even more critical.

---

## How Real Scientists Would Investigate This Claim


### Step 1: Question the Fundamental Premises


**Scientific Approach:**

- What creditable evidence supports the assumption that group differences in outcomes indicate systemic bias?  Appeals to authorities must be examined carefully.

- Under what conditions would group differences be expected even in perfectly fair systems?

- Are we conflating correlation with causation?

**Current "Equity Research" Approach:**

- Treats premise as axiomatic

- No testing of underlying assumptions

- Direct jump to data collection

- Data analysis is there only to measure the effects of the presumed causal covariance, not to verify empirically any causal assumptions made.

---

### Step 2: Form Multiple Competing Hypotheses

A proper scientific investigation would generate testable hypotheses:

**H₁: Discrimination Hypothesis**
- Differences reflect measurement bias or systemic discrimination
- *Prediction*: Differences should persist even when controlling for relevant variables

**H₂: Preparation/Effort Hypothesis** 
- Differences reflect genuine performance variations due to preparation, effort, or prior knowledge
- *Prediction*: Differences should correlate with measurable preparation factors

**H₃: Random Variation Hypothesis**
- Differences reflect normal statistical variation within acceptable bounds
- *Prediction*: Differences should fall within expected confidence intervals

**H₄: External Factors Hypothesis**
- Differences reflect cultural/family factors unrelated to school policy
- *Prediction*: School interventions should have minimal impact on these differences

---


### Step 3: Address Confounding Variables

::: {.callout-warning}
## Critical Issue: Rational Subgrouping

Current equity research fails to address whether compared groups are actually comparable.
:::

**Variables to Control For:**
- Socioeconomic status
- Family structure
- Time spent on homework
- Attendance rates
- Language spoken at home
- Prior educational preparation
- Cultural attitudes toward education

**Questions to Address:**
- Are we comparing truly comparable groups?
- What obvious explanatory variables are being ignored?
- How do we separate correlation from causation?


---

### Step 4: Establish Proper Experimental Controls

**Control Group Requirements:**
- Schools with similar demographics but different "equity" interventions
- Baseline measurements before any interventions
- Matched comparison groups

**Current Problems:**
- No control groups
- No baseline measurements
- No independent variables isolated


---

### Step 5: Account for Statistical Variation

::: {.callout-important}
## Statistical Reality

Differences will **ALWAYS** exist between any groups measured at any time, even between the same individuals tested at different times of day.
:::

**Scientific Questions:**
- What magnitude of difference is statistically significant?
- What falls within normal variation?
- Are we chasing statistical noise?
- What are the confidence intervals?

**Statistical Considerations:**
```r
# Example of proper statistical analysis
# Multiple comparisons correction needed
# Effect size calculation required  
# Confidence intervals essential
# Power analysis for sample size
```


---

### Step 6: Replication and Peer Review

**Scientific Standards:**
- Independent replication by other researchers
- Peer review of methodology
- Open data and reproducible analysis
- Pre-registration of hypotheses

**Current State:**
- Minimal independent replication
- Methodology rarely scrutinized
- Results assumed rather than tested

---


## Methodology Matrix: Experimental vs. Observational Data

### Steps Required for BOTH Experimental and Observational Studies

| Step | Experimental Data | Observational Data | 
|------|-------------------|-------------------|
| **Question Core Assumptions** | ✓ Essential | ✓ **CRITICAL** - Only way to avoid bias |
| **Multiple Competing Hypotheses** | ✓ Standard practice | ✓ **EVEN MORE Important** - Can't test assumptions directly |
| **Account for Statistical Variation** | ✓ Required | ✓ **EVEN MORE Critical** - Higher risk of noise |
| **Proper Statistical Testing** | ✓ Standard | ✓ **Enhanced Methods** - Need robustness checks |

---

### Steps That Differ Between Study Types

#### For Experimental Data (Rare in Social Science)

- **Random Assignment**: Researcher controls who gets treatment

- **Manipulation of Variables**: Can isolate causal mechanisms  

- **Direct Causation Testing**: Can establish cause-effect relationships

- **Controlled Environment**: Minimize confounding factors



#### For Observational Data (Most Social Science)

- **Quasi-Experimental Design**: Find "natural experiments"

- **Instrumental Variables**: Use external factors that affect treatment assignment

- **Regression Discontinuity**: Exploit arbitrary cutoffs in policy

- **Difference-in-Differences**: Compare changes over time between groups


---

## The Mathematical Foundations: Why Current Approaches Are Statistically Invalid

::: {.callout-critical}
## Fundamental Statistical Assumption Violation

All analytical statistics comparing groups rely on the mathematical requirement that **within-group variance should be small relative to between-group variance**. Current equity research systematically violates this assumption, rendering the statistical results mathematically meaningless.
:::

### The Mathematical Requirements for Valid Group Comparisons

For any comparative statistical analysis (ANOVA, t-tests, regression with categorical variables) to be valid:

**σ²(within) << σ²(between)**

Where:

- σ²(within) = variance within each group

- σ²(between) = variance between group means


#### When the Assumption is Violated

```{r}
#| label: variance-example

# Example: Current educational equity research
red_students <- c(300, 850, 1200, 1540, 1580)  # SAT scores within "Red" category
green_students <- c(400, 900, 1300, 1520, 1600)  # SAT scores within "Green" category

within_group_var <- var(red_students) + var(green_students)  # Massive
between_group_var <- var(c(mean(red_students), mean(green_students)))  # Small

# Create data for visualization
variance_data <- data.frame(
  Group = c("Red Students", "Green Students", "Between Groups"),
  Mean_Score = c(mean(red_students), mean(green_students), NA),
  Variance = c(var(red_students), var(green_students), between_group_var),
  SD = c(sd(red_students), sd(green_students), sqrt(between_group_var))
)

# Display results table
knitr::kable(variance_data, 
             digits = 1,
             caption = "Variance Analysis: Within-Group vs Between-Group",
             col.names = c("Group", "Mean Score", "Variance", "Standard Deviation"))

# Create distribution visualization
score_data <- data.frame(
  Score = c(red_students, green_students),
  Group = rep(c("Red", "Green"), each = 5)
)

ggplot(score_data, aes(x = Group, y = Score, fill = Group)) +
  geom_boxplot(alpha = 0.7, width = 0.5) +
  geom_jitter(width = 0.2, size = 3, alpha = 0.8) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 4, 
               fill = "white", color = "black") +
  scale_fill_manual(values = c("Red" = "#E74C3C", "Green" = "#27AE60")) +
  labs(title = "SAT Score Distributions: Massive Within-Group Variation",
       subtitle = "White diamonds show group means - note the overlap!",
       x = "Student Group", 
       y = "SAT Score",
       caption = "Within-group variance >> Between-group variance") +
  theme(legend.position = "none") +
  ylim(200, 1700)
```


### The F-Ratio Problem

In ANOVA, the F-statistic is calculated as:

**F = MS(between) / MS(within)**

When within-group variance is enormous (heterogeneous groups), the denominator inflates, making F-ratios artificially small and potentially masking real effects OR creating spurious effects depending on how the groups are constructed.


---

#### Real-World Consequences

**Educational Research:**
```{r}
#| label: heterogeneous-groups

# "Red students" category includes:
high_achieving_subgroup <- c(1400, 1450, 1500)  # High-achieving
middle_class_subgroup <- c(1200, 1350, 1400)  # Middle-class
disadvantaged_subgroup <- c(300, 400, 500)     # Low-resourced

# Create comprehensive data for visualization
all_red_students <- c(high_achieving_subgroup, middle_class_subgroup, disadvantaged_subgroup)
within_red_variance <- var(all_red_students)

# Create data frame for detailed analysis
subgroup_data <- data.frame(
  Score = c(high_achieving_subgroup, middle_class_subgroup, disadvantaged_subgroup),
  Subgroup = rep(c("High-Achieving", "Middle-Class", "Disadvantaged"), each = 3),
  Overall_Group = "Red Students"
)

# Calculate summary statistics
summary_stats <- subgroup_data %>%
  group_by(Subgroup) %>%
  summarise(
    Mean = mean(Score),
    SD = sd(Score),
    Min = min(Score),
    Max = max(Score),
    .groups = 'drop'
  ) %>%
  add_row(
    Subgroup = "Overall Red",
    Mean = mean(all_red_students),
    SD = sd(all_red_students),
    Min = min(all_red_students),
    Max = max(all_red_students)
  )

knitr::kable(summary_stats, 
             digits = 1,
             caption = "The Problem: Massive Heterogeneity Within 'Red Students'",
             col.names = c("Group", "Mean", "Std Dev", "Minimum", "Maximum"))

# Create visualization showing the problem
ggplot(subgroup_data, aes(x = Subgroup, y = Score, fill = Subgroup)) +
  geom_violin(alpha = 0.7, width = 0.8) +
  geom_jitter(width = 0.2, size = 2.5, alpha = 0.8) +
  geom_hline(yintercept = mean(all_red_students), 
             linetype = "dashed", color = "red", size = 1.2) +
  scale_fill_manual(values = c("High-Achieving" = "#27AE60", 
                              "Middle-Class" = "#F39C12", 
                              "Disadvantaged" = "#E74C3C")) +
  labs(title = "Within-Group Heterogeneity Makes Statistical Comparison Invalid",
       subtitle = "Red dashed line shows overall 'Red Student' mean - but it's meaningless!",
       x = "Subgroups Within 'Red Students'", 
       y = "SAT Score",
       caption = "Variance within 'Red Students' is larger than variance between demographic groups") +
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylim(200, 1600)
```

---

### The Women's Health Initiative Parallel

A perfect medical example of the same mathematical errors:

**WHI Study Design:**
- **"Women" category**: Ages 50-79 (heterogeneous)
- **Treatment**: Hormone therapy vs. placebo
- **Error**: Massive within-group age variance

**Mathematical Reality:**
```r
# Within "women" group
ages_50_55 <- beneficial_response   # HRT helps
ages_65_79 <- harmful_response      # HRT harmful

# Averaging across ages produces meaningless result
overall_effect <- mean(c(beneficial_response, harmful_response))
# Result: "HRT is harmful" - but this is mathematically invalid
```

**Corrected Analysis:**
```r
# Proper disaggregation by age
young_menopause <- HRT_effect[age >= 50 & age <= 55]  # Beneficial
late_menopause <- HRT_effect[age >= 65]               # Harmful

# Now within-group variance is small, between-group comparison valid
```

### Statistical Consequences of Heterogeneous Groups

#### 1. Unreliable Effect Sizes
Cohen's d and other effect size measures become meaningless:
```r
# With heterogeneous groups
d <- (mean_group1 - mean_group2) / pooled_SD
# When pooled_SD is inflated by within-group heterogeneity, 
# effect sizes are artificially deflated
```

#### 2. Invalid Confidence Intervals
```r
# Standard error calculation assumes homogeneous groups
SE <- SD / sqrt(n)
# When SD is inflated by heterogeneity, confidence intervals are wrong
```

#### 3. Type I and Type II Error Inflation
- **Type I**: Finding false differences due to arbitrary grouping
- **Type II**: Missing real differences due to noise from heterogeneous groups

F value`[1],
             summary(anova_heterogeneous)[[1]]---
title: "Scientific Analysis of Educational Equity Claims"
subtitle: "When Ideology Masquerades as Scientific Inquiry"
bibliography: manual-refs.bib
format:
  html:
    include-after-body: 
      - text: |
         <script type="text/javascript" src="reference-backlinks.js"></script>
    css: 
      - swart-20250630.css
      # - this-doc-only.css
    page-layout: full
    fig-width: 12
    fig-height: 10
    fig-dpi: 300
    df-print: paged
    code-overflow: wrap
    toc: true
    citeproc: true
    link-citations: true
  typst:
    fig-width: 12
    fig-height: 10
    fig-dpi: 300
    margin:
      x: 1in
      y: 1in
    toc: true
    fontsize: 14pt
    mainfont: "Latin Modern Roman"
execute:
  echo: false
  message: false
  warning: false
  fig-width: 12
  fig-height: 10
---


```{r}
#| label: setup

# load libraries
library(tidyverse)

# Set global theme for consistent plots
theme_set(theme_minimal(base_size = 16) + 
          theme(
    plot.title = element_text(face = "bold", size = 24),    # adjust title size
    plot.subtitle = element_text(face = "bold", size = 20), # adjust subtitle size
    axis.title.x = element_text(face = "bold"),
    axis.title.y = element_text(face = "bold"),
    axis.text = element_text(face = "bold"),
    legend.position = "bottom",
    strip.text = element_text(face = "bold"),
    panel.spacing.x = unit(1.5, "cm"),  # Horizontal spacing only
    panel.spacing.y = unit(1.5, "cm"),   # Vertical spacing only
    plot.margin = margin(20, 20, 20, 20, "pt")
   )
  )

# Set seed for reproducibility
set.seed(42)

```




# Scientific Analysis of Educational Equity Claims


## Abstract

An earnest discussion of the methodological deficiencies in current educational equity research, demonstrating how proper scientific investigation would approach claims about group differences in academic outcomes.  The astonishing fact is that most of the important research information is never presented, or even asked for!


## The Problematic Claim

> "For example, one way for school systems to support efforts towards equity in student outcomes is to frequently examine any differences in outcomes among student subgroups (Chapter 3)."

This statement comes early in the book and contains an **unproven assumption** that group differences inherently indicate systemic bias requiring intervention.

## Distinguishing Experimental vs. Observational Research

::: {.callout-warning}
## The Government Data Problem

Most social science researchers work with datasets containing government-specified subgroups (race, ethnicity, SES categories) rather than rationally selected variables for experimental validity. This creates systematic bias in research design from the outset.

**Additional Complications:**
- **Self-designation**: Individuals choose their own racial/ethnic categories
- **Multiple categories**: Many people belong to more than one subgroup
- **Assumed homogeneity**: Massive within-group differences are ignored
:::

### Experimental Data: Ideal Scientific Approach

When researchers can control variables and assign treatments randomly.  (Or, when causal mechanisms can be simulated with observational data based on DAG analysis.


### Observational Data: Constrained but Can Still Be Scientific

When working with existing datasets (most social science research), rigorous methodology becomes even more critical.

---

## How Real Scientists Would Investigate This Claim


### Step 1: Question the Fundamental Premises


**Scientific Approach:**

- What creditable evidence supports the assumption that group differences in outcomes indicate systemic bias?  Appeals to authorities must be examined carefully.

- Under what conditions would group differences be expected even in perfectly fair systems?

- Are we conflating correlation with causation?

**Current "Equity Research" Approach:**

- Treats premise as axiomatic

- No testing of underlying assumptions

- Direct jump to data collection

- Data analysis is there only to measure the effects of the presumed causal covariance, not to verify empirically any causal assumptions made.

---

### Step 2: Form Multiple Competing Hypotheses

A proper scientific investigation would generate testable hypotheses:

**H₁: Discrimination Hypothesis**
- Differences reflect measurement bias or systemic discrimination
- *Prediction*: Differences should persist even when controlling for relevant variables

**H₂: Preparation/Effort Hypothesis** 
- Differences reflect genuine performance variations due to preparation, effort, or prior knowledge
- *Prediction*: Differences should correlate with measurable preparation factors

**H₃: Random Variation Hypothesis**
- Differences reflect normal statistical variation within acceptable bounds
- *Prediction*: Differences should fall within expected confidence intervals

**H₄: External Factors Hypothesis**
- Differences reflect cultural/family factors unrelated to school policy
- *Prediction*: School interventions should have minimal impact on these differences

---


### Step 3: Address Confounding Variables

::: {.callout-warning}
## Critical Issue: Rational Subgrouping

Current equity research fails to address whether compared groups are actually comparable.
:::

**Variables to Control For:**
- Socioeconomic status
- Family structure
- Time spent on homework
- Attendance rates
- Language spoken at home
- Prior educational preparation
- Cultural attitudes toward education

**Questions to Address:**
- Are we comparing truly comparable groups?
- What obvious explanatory variables are being ignored?
- How do we separate correlation from causation?


---

### Step 4: Establish Proper Experimental Controls

**Control Group Requirements:**
- Schools with similar demographics but different "equity" interventions
- Baseline measurements before any interventions
- Matched comparison groups

**Current Problems:**
- No control groups
- No baseline measurements
- No independent variables isolated


---

### Step 5: Account for Statistical Variation

::: {.callout-important}
## Statistical Reality

Differences will **ALWAYS** exist between any groups measured at any time, even between the same individuals tested at different times of day.
:::

**Scientific Questions:**
- What magnitude of difference is statistically significant?
- What falls within normal variation?
- Are we chasing statistical noise?
- What are the confidence intervals?

**Statistical Considerations:**
```r
# Example of proper statistical analysis
# Multiple comparisons correction needed
# Effect size calculation required  
# Confidence intervals essential
# Power analysis for sample size
```


---

### Step 6: Replication and Peer Review

**Scientific Standards:**
- Independent replication by other researchers
- Peer review of methodology
- Open data and reproducible analysis
- Pre-registration of hypotheses

**Current State:**
- Minimal independent replication
- Methodology rarely scrutinized
- Results assumed rather than tested

---


## Methodology Matrix: Experimental vs. Observational Data

### Steps Required for BOTH Experimental and Observational Studies

| Step | Experimental Data | Observational Data | 
|------|-------------------|-------------------|
| **Question Core Assumptions** | ✓ Essential | ✓ **CRITICAL** - Only way to avoid bias |
| **Multiple Competing Hypotheses** | ✓ Standard practice | ✓ **EVEN MORE Important** - Can't test assumptions directly |
| **Account for Statistical Variation** | ✓ Required | ✓ **EVEN MORE Critical** - Higher risk of noise |
| **Proper Statistical Testing** | ✓ Standard | ✓ **Enhanced Methods** - Need robustness checks |

---

### Steps That Differ Between Study Types

#### For Experimental Data (Rare in Social Science)

- **Random Assignment**: Researcher controls who gets treatment

- **Manipulation of Variables**: Can isolate causal mechanisms  

- **Direct Causation Testing**: Can establish cause-effect relationships

- **Controlled Environment**: Minimize confounding factors



#### For Observational Data (Most Social Science)

- **Quasi-Experimental Design**: Find "natural experiments"

- **Instrumental Variables**: Use external factors that affect treatment assignment

- **Regression Discontinuity**: Exploit arbitrary cutoffs in policy

- **Difference-in-Differences**: Compare changes over time between groups


---

## The Mathematical Foundations: Why Current Approaches Are Statistically Invalid

::: {.callout-critical}
## Fundamental Statistical Assumption Violation

All analytical statistics comparing groups rely on the mathematical requirement that **within-group variance should be small relative to between-group variance**. Current equity research systematically violates this assumption, rendering the statistical results mathematically meaningless.
:::

### The Mathematical Requirements for Valid Group Comparisons

For any comparative statistical analysis (ANOVA, t-tests, regression with categorical variables) to be valid:

**σ²(within) << σ²(between)**

Where:

- σ²(within) = variance within each group

- σ²(between) = variance between group means


#### When the Assumption is Violated

```{r}
#| label: variance-example

# Example: Current educational equity research
red_students <- c(300, 850, 1200, 1540, 1580)  # SAT scores within "Red" category
green_students <- c(400, 900, 1300, 1520, 1600)  # SAT scores within "Green" category

within_group_var <- var(red_students) + var(green_students)  # Massive
between_group_var <- var(c(mean(red_students), mean(green_students)))  # Small

# Create data for visualization
variance_data <- data.frame(
  Group = c("Red Students", "Green Students", "Between Groups"),
  Mean_Score = c(mean(red_students), mean(green_students), NA),
  Variance = c(var(red_students), var(green_students), between_group_var),
  SD = c(sd(red_students), sd(green_students), sqrt(between_group_var))
)

# Display results table
knitr::kable(variance_data, 
             digits = 1,
             caption = "Variance Analysis: Within-Group vs Between-Group",
             col.names = c("Group", "Mean Score", "Variance", "Standard Deviation"))

# Create distribution visualization
score_data <- data.frame(
  Score = c(red_students, green_students),
  Group = rep(c("Red", "Green"), each = 5)
)

ggplot(score_data, aes(x = Group, y = Score, fill = Group)) +
  geom_boxplot(alpha = 0.7, width = 0.5) +
  geom_jitter(width = 0.2, size = 3, alpha = 0.8) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 4, 
               fill = "white", color = "black") +
  scale_fill_manual(values = c("Red" = "#E74C3C", "Green" = "#27AE60")) +
  labs(title = "SAT Score Distributions: Massive Within-Group Variation",
       subtitle = "White diamonds show group means - note the overlap!",
       x = "Student Group", 
       y = "SAT Score",
       caption = "Within-group variance >> Between-group variance") +
  theme(legend.position = "none") +
  ylim(200, 1700)
```


### The F-Ratio Problem

In ANOVA, the F-statistic is calculated as:

**F = MS(between) / MS(within)**

When within-group variance is enormous (heterogeneous groups), the denominator inflates, making F-ratios artificially small and potentially masking real effects OR creating spurious effects depending on how the groups are constructed.


---

#### Real-World Consequences

**Educational Research:**
```{r}
#| label: heterogeneous-groups

# "Red students" category includes:
high_achieving_subgroup <- c(1400, 1450, 1500)  # High-achieving
middle_class_subgroup <- c(1200, 1350, 1400)  # Middle-class
disadvantaged_subgroup <- c(300, 400, 500)     # Low-resourced

# Create comprehensive data for visualization
all_red_students <- c(high_achieving_subgroup, middle_class_subgroup, disadvantaged_subgroup)
within_red_variance <- var(all_red_students)

# Create data frame for detailed analysis
subgroup_data <- data.frame(
  Score = c(high_achieving_subgroup, middle_class_subgroup, disadvantaged_subgroup),
  Subgroup = rep(c("High-Achieving", "Middle-Class", "Disadvantaged"), each = 3),
  Overall_Group = "Red Students"
)

# Calculate summary statistics
summary_stats <- subgroup_data %>%
  group_by(Subgroup) %>%
  summarise(
    Mean = mean(Score),
    SD = sd(Score),
    Min = min(Score),
    Max = max(Score),
    .groups = 'drop'
  ) %>%
  add_row(
    Subgroup = "Overall Red",
    Mean = mean(all_red_students),
    SD = sd(all_red_students),
    Min = min(all_red_students),
    Max = max(all_red_students)
  )

knitr::kable(summary_stats, 
             digits = 1,
             caption = "The Problem: Massive Heterogeneity Within 'Red Students'",
             col.names = c("Group", "Mean", "Std Dev", "Minimum", "Maximum"))

# Create visualization showing the problem
ggplot(subgroup_data, aes(x = Subgroup, y = Score, fill = Subgroup)) +
  geom_violin(alpha = 0.7, width = 0.8) +
  geom_jitter(width = 0.2, size = 2.5, alpha = 0.8) +
  geom_hline(yintercept = mean(all_red_students), 
             linetype = "dashed", color = "red", size = 1.2) +
  scale_fill_manual(values = c("High-Achieving" = "#27AE60", 
                              "Middle-Class" = "#F39C12", 
                              "Disadvantaged" = "#E74C3C")) +
  labs(title = "Within-Group Heterogeneity Makes Statistical Comparison Invalid",
       subtitle = "Red dashed line shows overall 'Red Student' mean - but it's meaningless!",
       x = "Subgroups Within 'Red Students'", 
       y = "SAT Score",
       caption = "Variance within 'Red Students' is larger than variance between demographic groups") +
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylim(200, 1600)
```

---

### The Women's Health Initiative Parallel

A perfect medical example of the same mathematical errors:

**WHI Study Design:**
- **"Women" category**: Ages 50-79 (heterogeneous)
- **Treatment**: Hormone therapy vs. placebo
- **Error**: Massive within-group age variance

**Mathematical Reality:**
```r
# Within "women" group
ages_50_55 <- beneficial_response   # HRT helps
ages_65_79 <- harmful_response      # HRT harmful

# Averaging across ages produces meaningless result
overall_effect <- mean(c(beneficial_response, harmful_response))
# Result: "HRT is harmful" - but this is mathematically invalid
```

**Corrected Analysis:**
```r
# Proper disaggregation by age
young_menopause <- HRT_effect[age >= 50 & age <= 55]  # Beneficial
late_menopause <- HRT_effect[age >= 65]               # Harmful

# Now within-group variance is small, between-group comparison valid
```

### Statistical Consequences of Heterogeneous Groups

#### 1. Unreliable Effect Sizes
Cohen's d and other effect size measures become meaningless:
```r
# With heterogeneous groups
d <- (mean_group1 - mean_group2) / pooled_SD
# When pooled_SD is inflated by within-group heterogeneity, 
# effect sizes are artificially deflated
```

#### 2. Invalid Confidence Intervals
```r
# Standard error calculation assumes homogeneous groups
SE <- SD / sqrt(n)
# When SD is inflated by heterogeneity, confidence intervals are wrong
```

#### 3. Type I and Type II Error Inflation
- **Type I**: Finding false differences due to arbitrary grouping
- **Type II**: Missing real differences due to noise from heterogeneous groups

F value`[1]),
  ANOVA_P = c(summary(anova_homogeneous)[[1]]---
title: "Scientific Analysis of Educational Equity Claims"
subtitle: "When Ideology Masquerades as Scientific Inquiry"
bibliography: manual-refs.bib
format:
  html:
    include-after-body: 
      - text: |
         <script type="text/javascript" src="reference-backlinks.js"></script>
    css: 
      - swart-20250630.css
      # - this-doc-only.css
    page-layout: full
    fig-width: 12
    fig-height: 10
    fig-dpi: 300
    df-print: paged
    code-overflow: wrap
    toc: true
    citeproc: true
    link-citations: true
  typst:
    fig-width: 12
    fig-height: 10
    fig-dpi: 300
    margin:
      x: 1in
      y: 1in
    toc: true
    fontsize: 14pt
    mainfont: "Latin Modern Roman"
execute:
  echo: false
  message: false
  warning: false
  fig-width: 12
  fig-height: 10
---


```{r}
#| label: setup

# load libraries
library(tidyverse)

# Set global theme for consistent plots
theme_set(theme_minimal(base_size = 16) + 
          theme(
    plot.title = element_text(face = "bold", size = 24),    # adjust title size
    plot.subtitle = element_text(face = "bold", size = 20), # adjust subtitle size
    axis.title.x = element_text(face = "bold"),
    axis.title.y = element_text(face = "bold"),
    axis.text = element_text(face = "bold"),
    legend.position = "bottom",
    strip.text = element_text(face = "bold"),
    panel.spacing.x = unit(1.5, "cm"),  # Horizontal spacing only
    panel.spacing.y = unit(1.5, "cm"),   # Vertical spacing only
    plot.margin = margin(20, 20, 20, 20, "pt")
   )
  )

# Set seed for reproducibility
set.seed(42)

```




# Scientific Analysis of Educational Equity Claims


## Abstract

An earnest discussion of the methodological deficiencies in current educational equity research, demonstrating how proper scientific investigation would approach claims about group differences in academic outcomes.  The astonishing fact is that most of the important research information is never presented, or even asked for!


## The Problematic Claim

> "For example, one way for school systems to support efforts towards equity in student outcomes is to frequently examine any differences in outcomes among student subgroups (Chapter 3)."

This statement comes early in the book and contains an **unproven assumption** that group differences inherently indicate systemic bias requiring intervention.

## Distinguishing Experimental vs. Observational Research

::: {.callout-warning}
## The Government Data Problem

Most social science researchers work with datasets containing government-specified subgroups (race, ethnicity, SES categories) rather than rationally selected variables for experimental validity. This creates systematic bias in research design from the outset.

**Additional Complications:**
- **Self-designation**: Individuals choose their own racial/ethnic categories
- **Multiple categories**: Many people belong to more than one subgroup
- **Assumed homogeneity**: Massive within-group differences are ignored
:::

### Experimental Data: Ideal Scientific Approach

When researchers can control variables and assign treatments randomly.  (Or, when causal mechanisms can be simulated with observational data based on DAG analysis.


### Observational Data: Constrained but Can Still Be Scientific

When working with existing datasets (most social science research), rigorous methodology becomes even more critical.

---

## How Real Scientists Would Investigate This Claim


### Step 1: Question the Fundamental Premises


**Scientific Approach:**

- What creditable evidence supports the assumption that group differences in outcomes indicate systemic bias?  Appeals to authorities must be examined carefully.

- Under what conditions would group differences be expected even in perfectly fair systems?

- Are we conflating correlation with causation?

**Current "Equity Research" Approach:**

- Treats premise as axiomatic

- No testing of underlying assumptions

- Direct jump to data collection

- Data analysis is there only to measure the effects of the presumed causal covariance, not to verify empirically any causal assumptions made.

---

### Step 2: Form Multiple Competing Hypotheses

A proper scientific investigation would generate testable hypotheses:

**H₁: Discrimination Hypothesis**
- Differences reflect measurement bias or systemic discrimination
- *Prediction*: Differences should persist even when controlling for relevant variables

**H₂: Preparation/Effort Hypothesis** 
- Differences reflect genuine performance variations due to preparation, effort, or prior knowledge
- *Prediction*: Differences should correlate with measurable preparation factors

**H₃: Random Variation Hypothesis**
- Differences reflect normal statistical variation within acceptable bounds
- *Prediction*: Differences should fall within expected confidence intervals

**H₄: External Factors Hypothesis**
- Differences reflect cultural/family factors unrelated to school policy
- *Prediction*: School interventions should have minimal impact on these differences

---


### Step 3: Address Confounding Variables

::: {.callout-warning}
## Critical Issue: Rational Subgrouping

Current equity research fails to address whether compared groups are actually comparable.
:::

**Variables to Control For:**
- Socioeconomic status
- Family structure
- Time spent on homework
- Attendance rates
- Language spoken at home
- Prior educational preparation
- Cultural attitudes toward education

**Questions to Address:**
- Are we comparing truly comparable groups?
- What obvious explanatory variables are being ignored?
- How do we separate correlation from causation?


---

### Step 4: Establish Proper Experimental Controls

**Control Group Requirements:**
- Schools with similar demographics but different "equity" interventions
- Baseline measurements before any interventions
- Matched comparison groups

**Current Problems:**
- No control groups
- No baseline measurements
- No independent variables isolated


---

### Step 5: Account for Statistical Variation

::: {.callout-important}
## Statistical Reality

Differences will **ALWAYS** exist between any groups measured at any time, even between the same individuals tested at different times of day.
:::

**Scientific Questions:**
- What magnitude of difference is statistically significant?
- What falls within normal variation?
- Are we chasing statistical noise?
- What are the confidence intervals?

**Statistical Considerations:**
```r
# Example of proper statistical analysis
# Multiple comparisons correction needed
# Effect size calculation required  
# Confidence intervals essential
# Power analysis for sample size
```


---

### Step 6: Replication and Peer Review

**Scientific Standards:**
- Independent replication by other researchers
- Peer review of methodology
- Open data and reproducible analysis
- Pre-registration of hypotheses

**Current State:**
- Minimal independent replication
- Methodology rarely scrutinized
- Results assumed rather than tested

---


## Methodology Matrix: Experimental vs. Observational Data

### Steps Required for BOTH Experimental and Observational Studies

| Step | Experimental Data | Observational Data | 
|------|-------------------|-------------------|
| **Question Core Assumptions** | ✓ Essential | ✓ **CRITICAL** - Only way to avoid bias |
| **Multiple Competing Hypotheses** | ✓ Standard practice | ✓ **EVEN MORE Important** - Can't test assumptions directly |
| **Account for Statistical Variation** | ✓ Required | ✓ **EVEN MORE Critical** - Higher risk of noise |
| **Proper Statistical Testing** | ✓ Standard | ✓ **Enhanced Methods** - Need robustness checks |

---

### Steps That Differ Between Study Types

#### For Experimental Data (Rare in Social Science)

- **Random Assignment**: Researcher controls who gets treatment

- **Manipulation of Variables**: Can isolate causal mechanisms  

- **Direct Causation Testing**: Can establish cause-effect relationships

- **Controlled Environment**: Minimize confounding factors



#### For Observational Data (Most Social Science)

- **Quasi-Experimental Design**: Find "natural experiments"

- **Instrumental Variables**: Use external factors that affect treatment assignment

- **Regression Discontinuity**: Exploit arbitrary cutoffs in policy

- **Difference-in-Differences**: Compare changes over time between groups


---

## The Mathematical Foundations: Why Current Approaches Are Statistically Invalid

::: {.callout-critical}
## Fundamental Statistical Assumption Violation

All analytical statistics comparing groups rely on the mathematical requirement that **within-group variance should be small relative to between-group variance**. Current equity research systematically violates this assumption, rendering the statistical results mathematically meaningless.
:::

### The Mathematical Requirements for Valid Group Comparisons

For any comparative statistical analysis (ANOVA, t-tests, regression with categorical variables) to be valid:

**σ²(within) << σ²(between)**

Where:

- σ²(within) = variance within each group

- σ²(between) = variance between group means


#### When the Assumption is Violated

```{r}
#| label: variance-example

# Example: Current educational equity research
red_students <- c(300, 850, 1200, 1540, 1580)  # SAT scores within "Red" category
green_students <- c(400, 900, 1300, 1520, 1600)  # SAT scores within "Green" category

within_group_var <- var(red_students) + var(green_students)  # Massive
between_group_var <- var(c(mean(red_students), mean(green_students)))  # Small

# Create data for visualization
variance_data <- data.frame(
  Group = c("Red Students", "Green Students", "Between Groups"),
  Mean_Score = c(mean(red_students), mean(green_students), NA),
  Variance = c(var(red_students), var(green_students), between_group_var),
  SD = c(sd(red_students), sd(green_students), sqrt(between_group_var))
)

# Display results table
knitr::kable(variance_data, 
             digits = 1,
             caption = "Variance Analysis: Within-Group vs Between-Group",
             col.names = c("Group", "Mean Score", "Variance", "Standard Deviation"))

# Create distribution visualization
score_data <- data.frame(
  Score = c(red_students, green_students),
  Group = rep(c("Red", "Green"), each = 5)
)

ggplot(score_data, aes(x = Group, y = Score, fill = Group)) +
  geom_boxplot(alpha = 0.7, width = 0.5) +
  geom_jitter(width = 0.2, size = 3, alpha = 0.8) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 4, 
               fill = "white", color = "black") +
  scale_fill_manual(values = c("Red" = "#E74C3C", "Green" = "#27AE60")) +
  labs(title = "SAT Score Distributions: Massive Within-Group Variation",
       subtitle = "White diamonds show group means - note the overlap!",
       x = "Student Group", 
       y = "SAT Score",
       caption = "Within-group variance >> Between-group variance") +
  theme(legend.position = "none") +
  ylim(200, 1700)
```


### The F-Ratio Problem

In ANOVA, the F-statistic is calculated as:

**F = MS(between) / MS(within)**

When within-group variance is enormous (heterogeneous groups), the denominator inflates, making F-ratios artificially small and potentially masking real effects OR creating spurious effects depending on how the groups are constructed.


---

#### Real-World Consequences

**Educational Research:**
```{r}
#| label: heterogeneous-groups

# "Red students" category includes:
high_achieving_subgroup <- c(1400, 1450, 1500)  # High-achieving
middle_class_subgroup <- c(1200, 1350, 1400)  # Middle-class
disadvantaged_subgroup <- c(300, 400, 500)     # Low-resourced

# Create comprehensive data for visualization
all_red_students <- c(high_achieving_subgroup, middle_class_subgroup, disadvantaged_subgroup)
within_red_variance <- var(all_red_students)

# Create data frame for detailed analysis
subgroup_data <- data.frame(
  Score = c(high_achieving_subgroup, middle_class_subgroup, disadvantaged_subgroup),
  Subgroup = rep(c("High-Achieving", "Middle-Class", "Disadvantaged"), each = 3),
  Overall_Group = "Red Students"
)

# Calculate summary statistics
summary_stats <- subgroup_data %>%
  group_by(Subgroup) %>%
  summarise(
    Mean = mean(Score),
    SD = sd(Score),
    Min = min(Score),
    Max = max(Score),
    .groups = 'drop'
  ) %>%
  add_row(
    Subgroup = "Overall Red",
    Mean = mean(all_red_students),
    SD = sd(all_red_students),
    Min = min(all_red_students),
    Max = max(all_red_students)
  )

knitr::kable(summary_stats, 
             digits = 1,
             caption = "The Problem: Massive Heterogeneity Within 'Red Students'",
             col.names = c("Group", "Mean", "Std Dev", "Minimum", "Maximum"))

# Create visualization showing the problem
ggplot(subgroup_data, aes(x = Subgroup, y = Score, fill = Subgroup)) +
  geom_violin(alpha = 0.7, width = 0.8) +
  geom_jitter(width = 0.2, size = 2.5, alpha = 0.8) +
  geom_hline(yintercept = mean(all_red_students), 
             linetype = "dashed", color = "red", size = 1.2) +
  scale_fill_manual(values = c("High-Achieving" = "#27AE60", 
                              "Middle-Class" = "#F39C12", 
                              "Disadvantaged" = "#E74C3C")) +
  labs(title = "Within-Group Heterogeneity Makes Statistical Comparison Invalid",
       subtitle = "Red dashed line shows overall 'Red Student' mean - but it's meaningless!",
       x = "Subgroups Within 'Red Students'", 
       y = "SAT Score",
       caption = "Variance within 'Red Students' is larger than variance between demographic groups") +
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylim(200, 1600)
```

---

### The Women's Health Initiative Parallel

A perfect medical example of the same mathematical errors:

**WHI Study Design:**
- **"Women" category**: Ages 50-79 (heterogeneous)
- **Treatment**: Hormone therapy vs. placebo
- **Error**: Massive within-group age variance

**Mathematical Reality:**
```r
# Within "women" group
ages_50_55 <- beneficial_response   # HRT helps
ages_65_79 <- harmful_response      # HRT harmful

# Averaging across ages produces meaningless result
overall_effect <- mean(c(beneficial_response, harmful_response))
# Result: "HRT is harmful" - but this is mathematically invalid
```

**Corrected Analysis:**
```r
# Proper disaggregation by age
young_menopause <- HRT_effect[age >= 50 & age <= 55]  # Beneficial
late_menopause <- HRT_effect[age >= 65]               # Harmful

# Now within-group variance is small, between-group comparison valid
```

### Statistical Consequences of Heterogeneous Groups

#### 1. Unreliable Effect Sizes
Cohen's d and other effect size measures become meaningless:
```r
# With heterogeneous groups
d <- (mean_group1 - mean_group2) / pooled_SD
# When pooled_SD is inflated by within-group heterogeneity, 
# effect sizes are artificially deflated
```

#### 2. Invalid Confidence Intervals
```r
# Standard error calculation assumes homogeneous groups
SE <- SD / sqrt(n)
# When SD is inflated by heterogeneity, confidence intervals are wrong
```

#### 3. Type I and Type II Error Inflation
- **Type I**: Finding false differences due to arbitrary grouping
- **Type II**: Missing real differences due to noise from heterogeneous groups

Pr(>F)`[1],
             summary(anova_heterogeneous)[[1]]---
title: "Scientific Analysis of Educational Equity Claims"
subtitle: "When Ideology Masquerades as Scientific Inquiry"
bibliography: manual-refs.bib
format:
  html:
    include-after-body: 
      - text: |
         <script type="text/javascript" src="reference-backlinks.js"></script>
    css: 
      - swart-20250630.css
      # - this-doc-only.css
    page-layout: full
    fig-width: 12
    fig-height: 10
    fig-dpi: 300
    df-print: paged
    code-overflow: wrap
    toc: true
    citeproc: true
    link-citations: true
  typst:
    fig-width: 12
    fig-height: 10
    fig-dpi: 300
    margin:
      x: 1in
      y: 1in
    toc: true
    fontsize: 14pt
    mainfont: "Latin Modern Roman"
execute:
  echo: false
  message: false
  warning: false
  fig-width: 12
  fig-height: 10
---


```{r}
#| label: setup

# load libraries
library(tidyverse)

# Set global theme for consistent plots
theme_set(theme_minimal(base_size = 16) + 
          theme(
    plot.title = element_text(face = "bold", size = 24),    # adjust title size
    plot.subtitle = element_text(face = "bold", size = 20), # adjust subtitle size
    axis.title.x = element_text(face = "bold"),
    axis.title.y = element_text(face = "bold"),
    axis.text = element_text(face = "bold"),
    legend.position = "bottom",
    strip.text = element_text(face = "bold"),
    panel.spacing.x = unit(1.5, "cm"),  # Horizontal spacing only
    panel.spacing.y = unit(1.5, "cm"),   # Vertical spacing only
    plot.margin = margin(20, 20, 20, 20, "pt")
   )
  )

# Set seed for reproducibility
set.seed(42)

```




# Scientific Analysis of Educational Equity Claims


## Abstract

An earnest discussion of the methodological deficiencies in current educational equity research, demonstrating how proper scientific investigation would approach claims about group differences in academic outcomes.  The astonishing fact is that most of the important research information is never presented, or even asked for!


## The Problematic Claim

> "For example, one way for school systems to support efforts towards equity in student outcomes is to frequently examine any differences in outcomes among student subgroups (Chapter 3)."

This statement comes early in the book and contains an **unproven assumption** that group differences inherently indicate systemic bias requiring intervention.

## Distinguishing Experimental vs. Observational Research

::: {.callout-warning}
## The Government Data Problem

Most social science researchers work with datasets containing government-specified subgroups (race, ethnicity, SES categories) rather than rationally selected variables for experimental validity. This creates systematic bias in research design from the outset.

**Additional Complications:**
- **Self-designation**: Individuals choose their own racial/ethnic categories
- **Multiple categories**: Many people belong to more than one subgroup
- **Assumed homogeneity**: Massive within-group differences are ignored
:::

### Experimental Data: Ideal Scientific Approach

When researchers can control variables and assign treatments randomly.  (Or, when causal mechanisms can be simulated with observational data based on DAG analysis.


### Observational Data: Constrained but Can Still Be Scientific

When working with existing datasets (most social science research), rigorous methodology becomes even more critical.

---

## How Real Scientists Would Investigate This Claim


### Step 1: Question the Fundamental Premises


**Scientific Approach:**

- What creditable evidence supports the assumption that group differences in outcomes indicate systemic bias?  Appeals to authorities must be examined carefully.

- Under what conditions would group differences be expected even in perfectly fair systems?

- Are we conflating correlation with causation?

**Current "Equity Research" Approach:**

- Treats premise as axiomatic

- No testing of underlying assumptions

- Direct jump to data collection

- Data analysis is there only to measure the effects of the presumed causal covariance, not to verify empirically any causal assumptions made.

---

### Step 2: Form Multiple Competing Hypotheses

A proper scientific investigation would generate testable hypotheses:

**H₁: Discrimination Hypothesis**
- Differences reflect measurement bias or systemic discrimination
- *Prediction*: Differences should persist even when controlling for relevant variables

**H₂: Preparation/Effort Hypothesis** 
- Differences reflect genuine performance variations due to preparation, effort, or prior knowledge
- *Prediction*: Differences should correlate with measurable preparation factors

**H₃: Random Variation Hypothesis**
- Differences reflect normal statistical variation within acceptable bounds
- *Prediction*: Differences should fall within expected confidence intervals

**H₄: External Factors Hypothesis**
- Differences reflect cultural/family factors unrelated to school policy
- *Prediction*: School interventions should have minimal impact on these differences

---


### Step 3: Address Confounding Variables

::: {.callout-warning}
## Critical Issue: Rational Subgrouping

Current equity research fails to address whether compared groups are actually comparable.
:::

**Variables to Control For:**
- Socioeconomic status
- Family structure
- Time spent on homework
- Attendance rates
- Language spoken at home
- Prior educational preparation
- Cultural attitudes toward education

**Questions to Address:**
- Are we comparing truly comparable groups?
- What obvious explanatory variables are being ignored?
- How do we separate correlation from causation?


---

### Step 4: Establish Proper Experimental Controls

**Control Group Requirements:**
- Schools with similar demographics but different "equity" interventions
- Baseline measurements before any interventions
- Matched comparison groups

**Current Problems:**
- No control groups
- No baseline measurements
- No independent variables isolated


---

### Step 5: Account for Statistical Variation

::: {.callout-important}
## Statistical Reality

Differences will **ALWAYS** exist between any groups measured at any time, even between the same individuals tested at different times of day.
:::

**Scientific Questions:**
- What magnitude of difference is statistically significant?
- What falls within normal variation?
- Are we chasing statistical noise?
- What are the confidence intervals?

**Statistical Considerations:**
```r
# Example of proper statistical analysis
# Multiple comparisons correction needed
# Effect size calculation required  
# Confidence intervals essential
# Power analysis for sample size
```


---

### Step 6: Replication and Peer Review

**Scientific Standards:**
- Independent replication by other researchers
- Peer review of methodology
- Open data and reproducible analysis
- Pre-registration of hypotheses

**Current State:**
- Minimal independent replication
- Methodology rarely scrutinized
- Results assumed rather than tested

---


## Methodology Matrix: Experimental vs. Observational Data

### Steps Required for BOTH Experimental and Observational Studies

| Step | Experimental Data | Observational Data | 
|------|-------------------|-------------------|
| **Question Core Assumptions** | ✓ Essential | ✓ **CRITICAL** - Only way to avoid bias |
| **Multiple Competing Hypotheses** | ✓ Standard practice | ✓ **EVEN MORE Important** - Can't test assumptions directly |
| **Account for Statistical Variation** | ✓ Required | ✓ **EVEN MORE Critical** - Higher risk of noise |
| **Proper Statistical Testing** | ✓ Standard | ✓ **Enhanced Methods** - Need robustness checks |

---

### Steps That Differ Between Study Types

#### For Experimental Data (Rare in Social Science)

- **Random Assignment**: Researcher controls who gets treatment

- **Manipulation of Variables**: Can isolate causal mechanisms  

- **Direct Causation Testing**: Can establish cause-effect relationships

- **Controlled Environment**: Minimize confounding factors



#### For Observational Data (Most Social Science)

- **Quasi-Experimental Design**: Find "natural experiments"

- **Instrumental Variables**: Use external factors that affect treatment assignment

- **Regression Discontinuity**: Exploit arbitrary cutoffs in policy

- **Difference-in-Differences**: Compare changes over time between groups


---

## The Mathematical Foundations: Why Current Approaches Are Statistically Invalid

::: {.callout-critical}
## Fundamental Statistical Assumption Violation

All analytical statistics comparing groups rely on the mathematical requirement that **within-group variance should be small relative to between-group variance**. Current equity research systematically violates this assumption, rendering the statistical results mathematically meaningless.
:::

### The Mathematical Requirements for Valid Group Comparisons

For any comparative statistical analysis (ANOVA, t-tests, regression with categorical variables) to be valid:

**σ²(within) << σ²(between)**

Where:

- σ²(within) = variance within each group

- σ²(between) = variance between group means


#### When the Assumption is Violated

```{r}
#| label: variance-example

# Example: Current educational equity research
red_students <- c(300, 850, 1200, 1540, 1580)  # SAT scores within "Red" category
green_students <- c(400, 900, 1300, 1520, 1600)  # SAT scores within "Green" category

within_group_var <- var(red_students) + var(green_students)  # Massive
between_group_var <- var(c(mean(red_students), mean(green_students)))  # Small

# Create data for visualization
variance_data <- data.frame(
  Group = c("Red Students", "Green Students", "Between Groups"),
  Mean_Score = c(mean(red_students), mean(green_students), NA),
  Variance = c(var(red_students), var(green_students), between_group_var),
  SD = c(sd(red_students), sd(green_students), sqrt(between_group_var))
)

# Display results table
knitr::kable(variance_data, 
             digits = 1,
             caption = "Variance Analysis: Within-Group vs Between-Group",
             col.names = c("Group", "Mean Score", "Variance", "Standard Deviation"))

# Create distribution visualization
score_data <- data.frame(
  Score = c(red_students, green_students),
  Group = rep(c("Red", "Green"), each = 5)
)

ggplot(score_data, aes(x = Group, y = Score, fill = Group)) +
  geom_boxplot(alpha = 0.7, width = 0.5) +
  geom_jitter(width = 0.2, size = 3, alpha = 0.8) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 4, 
               fill = "white", color = "black") +
  scale_fill_manual(values = c("Red" = "#E74C3C", "Green" = "#27AE60")) +
  labs(title = "SAT Score Distributions: Massive Within-Group Variation",
       subtitle = "White diamonds show group means - note the overlap!",
       x = "Student Group", 
       y = "SAT Score",
       caption = "Within-group variance >> Between-group variance") +
  theme(legend.position = "none") +
  ylim(200, 1700)
```


### The F-Ratio Problem

In ANOVA, the F-statistic is calculated as:

**F = MS(between) / MS(within)**

When within-group variance is enormous (heterogeneous groups), the denominator inflates, making F-ratios artificially small and potentially masking real effects OR creating spurious effects depending on how the groups are constructed.


---

#### Real-World Consequences

**Educational Research:**
```{r}
#| label: heterogeneous-groups

# "Red students" category includes:
high_achieving_subgroup <- c(1400, 1450, 1500)  # High-achieving
middle_class_subgroup <- c(1200, 1350, 1400)  # Middle-class
disadvantaged_subgroup <- c(300, 400, 500)     # Low-resourced

# Create comprehensive data for visualization
all_red_students <- c(high_achieving_subgroup, middle_class_subgroup, disadvantaged_subgroup)
within_red_variance <- var(all_red_students)

# Create data frame for detailed analysis
subgroup_data <- data.frame(
  Score = c(high_achieving_subgroup, middle_class_subgroup, disadvantaged_subgroup),
  Subgroup = rep(c("High-Achieving", "Middle-Class", "Disadvantaged"), each = 3),
  Overall_Group = "Red Students"
)

# Calculate summary statistics
summary_stats <- subgroup_data %>%
  group_by(Subgroup) %>%
  summarise(
    Mean = mean(Score),
    SD = sd(Score),
    Min = min(Score),
    Max = max(Score),
    .groups = 'drop'
  ) %>%
  add_row(
    Subgroup = "Overall Red",
    Mean = mean(all_red_students),
    SD = sd(all_red_students),
    Min = min(all_red_students),
    Max = max(all_red_students)
  )

knitr::kable(summary_stats, 
             digits = 1,
             caption = "The Problem: Massive Heterogeneity Within 'Red Students'",
             col.names = c("Group", "Mean", "Std Dev", "Minimum", "Maximum"))

# Create visualization showing the problem
ggplot(subgroup_data, aes(x = Subgroup, y = Score, fill = Subgroup)) +
  geom_violin(alpha = 0.7, width = 0.8) +
  geom_jitter(width = 0.2, size = 2.5, alpha = 0.8) +
  geom_hline(yintercept = mean(all_red_students), 
             linetype = "dashed", color = "red", size = 1.2) +
  scale_fill_manual(values = c("High-Achieving" = "#27AE60", 
                              "Middle-Class" = "#F39C12", 
                              "Disadvantaged" = "#E74C3C")) +
  labs(title = "Within-Group Heterogeneity Makes Statistical Comparison Invalid",
       subtitle = "Red dashed line shows overall 'Red Student' mean - but it's meaningless!",
       x = "Subgroups Within 'Red Students'", 
       y = "SAT Score",
       caption = "Variance within 'Red Students' is larger than variance between demographic groups") +
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 45, hjust = 1)) +
  ylim(200, 1600)
```

---

### The Women's Health Initiative Parallel

A perfect medical example of the same mathematical errors:

**WHI Study Design:**
- **"Women" category**: Ages 50-79 (heterogeneous)
- **Treatment**: Hormone therapy vs. placebo
- **Error**: Massive within-group age variance

**Mathematical Reality:**
```r
# Within "women" group
ages_50_55 <- beneficial_response   # HRT helps
ages_65_79 <- harmful_response      # HRT harmful

# Averaging across ages produces meaningless result
overall_effect <- mean(c(beneficial_response, harmful_response))
# Result: "HRT is harmful" - but this is mathematically invalid
```

**Corrected Analysis:**
```r
# Proper disaggregation by age
young_menopause <- HRT_effect[age >= 50 & age <= 55]  # Beneficial
late_menopause <- HRT_effect[age >= 65]               # Harmful

# Now within-group variance is small, between-group comparison valid
```

### Statistical Consequences of Heterogeneous Groups

#### 1. Unreliable Effect Sizes
Cohen's d and other effect size measures become meaningless:
```r
# With heterogeneous groups
d <- (mean_group1 - mean_group2) / pooled_SD
# When pooled_SD is inflated by within-group heterogeneity, 
# effect sizes are artificially deflated
```

#### 2. Invalid Confidence Intervals
```r
# Standard error calculation assumes homogeneous groups
SE <- SD / sqrt(n)
# When SD is inflated by heterogeneity, confidence intervals are wrong
```

#### 3. Type I and Type II Error Inflation
- **Type I**: Finding false differences due to arbitrary grouping
- **Type II**: Missing real differences due to noise from heterogeneous groups

Pr(>F)`[1]),
  Valid_Comparison = c("YES", "NO")
)

knitr::kable(test_results, 
             digits = 4,
             caption = "Why Homogeneity Testing is Critical Before Group Comparisons",
             col.names = c("Group Type", "F-test (Variance)", "P-value (Variance)", 
                          "ANOVA F", "ANOVA P", "Valid?"))

# Create visualization
ggplot(homogeneity_data, aes(x = Group, y = Score, fill = Group)) +
  geom_violin(alpha = 0.7) +
  geom_boxplot(width = 0.3, alpha = 0.8) +
  facet_wrap(~Type, scales = "free_y") +
  scale_fill_manual(values = c("A" = "#E74C3C", "B" = "#3498DB")) +
  labs(title = "Valid vs Invalid Group Comparisons",
       subtitle = "Left: Valid comparison (similar variances). Right: Invalid (heterogeneous groups)",
       x = "Group", 
       y = "Test Score",
       caption = "Most educational equity research would fail the homogeneity test") +
  theme(legend.position = "none")
```

### Mathematical Requirements for Valid Analysis

#### Step 1: Variance Decomposition
```r
# Calculate variance components
total_variance <- var(all_students)
within_group_variance <- sum(group_variances * group_sizes) / total_n
between_group_variance <- total_variance - within_group_variance

# Valid comparison requires: between_group_variance > within_group_variance
```

#### Step 2: Intraclass Correlation
```r
# ICC should be high for meaningful group comparisons
ICC <- between_group_variance / total_variance
# ICC < 0.1 suggests grouping is not meaningful
```

### The Mathematical Reality in Educational Research

Most educational equity studies would show:

```{r}
#| label: variance-decomposition

# Typical results if properly calculated
variance_within_racial_groups <- 0.85  # 85% of variance
variance_between_racial_groups <- 0.15  # 15% of variance

# Create data for visualization
variance_breakdown <- data.frame(
  Source = c("Within Demographic Groups", "Between Demographic Groups"),
  Percentage = c(variance_within_racial_groups * 100, 
                variance_between_racial_groups * 100),
  Description = c("Individual differences within each group", 
                 "Average differences between groups")
)

# Create summary table
knitr::kable(variance_breakdown, 
             digits = 1,
             caption = "Typical Variance Decomposition in Educational Research",
             col.names = c("Variance Source", "Percentage (%)", "What This Means"))

# Create pie chart
ggplot(variance_breakdown, aes(x = "", y = Percentage, fill = Source)) +
  geom_bar(stat = "identity", width = 1, color = "white", size = 2) +
  coord_polar("y", start = 0) +
  scale_fill_manual(values = c("Within Demographic Groups" = "#E74C3C", 
                              "Between Demographic Groups" = "#3498DB")) +
  labs(title = "Where Does Academic Variance Actually Come From?",
       subtitle = "Demographic categories explain only 15% of student performance",
       caption = "Yet policies focus entirely on the 15% while ignoring the 85%") +
  theme_void() +
  theme(legend.position = "bottom",
        legend.title = element_blank()) +
  geom_text(aes(label = paste0(Percentage, "%")), 
            position = position_stack(vjust = 0.5),
            size = 6, fontface = "bold", color = "white")

# Create bar chart alternative
ggplot(variance_breakdown, aes(x = Source, y = Percentage, fill = Source)) +
  geom_col(width = 0.7, alpha = 0.8) +
  scale_fill_manual(values = c("Within Demographic Groups" = "#E74C3C", 
                              "Between Demographic Groups" = "#3498DB")) +
  labs(title = "The Fundamental Problem with Demographic-Based Policy",
       subtitle = "85% of academic variance occurs within groups, not between them",
       x = "Source of Variance", 
       y = "Percentage of Total Variance",
       caption = "Focusing on group differences misses most of what matters for student success") +
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 45, hjust = 1)) +
  geom_text(aes(label = paste0(Percentage, "%")), 
            vjust = -0.5, size = 5, fontface = "bold") +
  ylim(0, 100)
```

::: {.callout-important}
## Bottom Line for Statisticians

When within-group variance exceeds between-group variance, you're not measuring group differences - you're measuring the noise created by improper categorization. The statistical analysis becomes mathematically invalid, regardless of sample size or p-values.
:::

## The Fundamental Problem: Rational Subgrouping

::: {.callout-important}
## The Core Issue: Comparing Apples to Oranges

Current equity research fails at the most basic level - it doesn't establish that comparison groups are actually comparable. The fundamental flaw is treating government-defined demographic categories as if they represent homogeneous groups.
:::

#### The Self-Designation Problem

**Current Practice:**
- Individuals self-select racial/ethnic categories
- Many belong to multiple categories simultaneously  
- Categories may reflect social identity rather than relevant characteristics
- No verification of category membership

**Scientific Implications:**
```r
# What are we actually measuring?
hispanic_group <- students[ethnicity == "Hispanic"]  
# Could include: Mexican, Salvadoran, Spanish, Brazilian, etc.
# Different languages, cultures, socioeconomic backgrounds
# Different immigration histories, family structures
```

#### The False Homogeneity Assumption

Government categories assume internal similarity that often doesn't exist:

**Within "Red" Students:**
- Recent African immigrants vs. descendants of slaves
- Caribbean immigrants vs. African Americans  
- Different socioeconomic levels
- Urban vs. rural backgrounds
- Different family structures

**Within "Green" Students:**
- Chinese vs. Hmong vs. Indian vs. Japanese
- Different languages and cultures
- Vastly different socioeconomic backgrounds
- Different immigration patterns

#### The Thomas Sowell Principle: Disaggregate Until Comparable

**The Medical Doctor Example:**

Instead of comparing ALL male doctors to ALL female doctors:

```{r}
#| label: sowell-principle

# Simulate realistic doctor salary data
set.seed(123)

# All male doctors (mixed career paths)
all_male_doctors <- c(
  rnorm(50, 280000, 20000),  # Continuous career
  rnorm(20, 250000, 15000)   # Some variation
)

# All female doctors (mixed career paths)  
all_female_doctors <- c(
  rnorm(30, 290000, 18000),  # Never married, no breaks (comparable to men)
  rnorm(40, 180000, 25000)   # Career breaks for children
)

# Comparable subgroups (never married, no career breaks, no children)
comparable_male <- rnorm(30, 285000, 18000)
comparable_female <- rnorm(30, 288000, 18000)

# Create comprehensive data frame
doctor_data <- data.frame(
  Salary = c(all_male_doctors, all_female_doctors, comparable_male, comparable_female),
  Gender = rep(c("Male", "Female", "Male", "Female"), 
               c(length(all_male_doctors), length(all_female_doctors), 
                 length(comparable_male), length(comparable_female))),
  Analysis = rep(c("All Doctors", "All Doctors", "Comparable Only", "Comparable Only"),
                c(length(all_male_doctors), length(all_female_doctors),
                  length(comparable_male), length(comparable_female)))
)

# Calculate summary statistics
salary_summary <- doctor_data %>%
  group_by(Analysis, Gender) %>%
  summarise(
    Mean_Salary = mean(Salary),
    SD = sd(Salary),
    N = n(),
    .groups = 'drop'
  ) %>%
  pivot_wider(names_from = Gender, values_from = c(Mean_Salary, SD, N)) %>%
  mutate(
    Gap = Mean_Salary_Male - Mean_Salary_Female,
    Gap_Percent = (Gap / Mean_Salary_Female) * 100
  )

knitr::kable(salary_summary, 
             digits = 0,
             caption = "The Thomas Sowell Principle: Proper Subgrouping Eliminates Apparent Discrimination",
             col.names = c("Analysis Type", "Male Mean", "Female Mean", "Male SD", "Female SD", 
                          "Male N", "Female N", "Gap ($)", "Gap (%)"))

# Create visualization
ggplot(doctor_data, aes(x = interaction(Gender, Analysis), y = Salary, fill = Gender)) +
  geom_violin(alpha = 0.7, width = 0.8) +
  geom_boxplot(width = 0.3, alpha = 0.8, outlier.shape = NA) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 4, 
               fill = "white", color = "black") +
  scale_fill_manual(values = c("Male" = "#3498DB", "Female" = "#E74C3C")) +
  scale_x_discrete(labels = c("Male\n(All)", "Female\n(All)", 
                             "Male\n(Comparable)", "Female\n(Comparable)")) +
  labs(title = "How Proper Subgrouping Reveals the Truth",
       subtitle = "White diamonds show means - note how the gap disappears with comparable groups",
       x = "Doctor Groups", 
       y = "Annual Salary ($)",
       caption = "Gap disappears when comparing truly comparable individuals") +
  theme(legend.position = "none") +
  scale_y_continuous(labels = scales::dollar_format(scale = 1e-3, suffix = "K")) +
  annotate("text", x = 1.5, y = 350000, label = "APPARENT\nDISCRIMINATION", 
           size = 4, fontface = "bold", color = "red") +
  annotate("text", x = 3.5, y = 350000, label = "NO REAL\nDISCRIMINATION", 
           size = 4, fontface = "bold", color = "darkgreen")
```

**Result:** The "gender gap" disappears when comparing truly comparable individuals.

#### Applying This to Educational Research

**Instead of:**
- Comparing all Red students to all Green students
- Comparing all Blue students to all Green students

**Scientific approach:**
- Compare high-SES Red students to high-SES Green students
- Compare recent immigrant Green students to recent immigrant Blue students  
- Compare students with similar family structures across racial groups
- Compare students with similar prior preparation across racial groups

#### The Hidden Truth: Within-Group Variation

::: {.callout-note}
## Key Insight

High-performing Red, Blue, Green, and other students often have more in common with each other than with low-performing members of their own racial group.
:::

**Common characteristics of high-performers regardless of race:**
- Stable family structures
- High parental education expectations
- Consistent school attendance
- Time spent on homework
- Participation in academic activities

**This suggests the real variables of interest are:**
- Family structure and stability
- Cultural attitudes toward education  
- Economic resources
- Prior educational preparation
- Peer influences

**NOT racial categories themselves.**

#### Practical Implementation of Rational Subgrouping

```{r}
#| label: rational-subgrouping

# Simulate realistic student data
set.seed(789)
n_students <- 200

# Generate realistic student data
student_data <- data.frame(
  student_id = 1:n_students,
  demographic = sample(c("Red", "Green", "Blue"), n_students, 
                      prob = c(0.4, 0.4, 0.2), replace = TRUE),
  family_income = sample(c("Low", "Middle", "High"), n_students, 
                        prob = c(0.3, 0.4, 0.3), replace = TRUE),
  parent_education = sample(c("No College", "Some College", "College+"), n_students,
                           prob = c(0.25, 0.35, 0.4), replace = TRUE),
  family_structure = sample(c("Two Parent", "Single Parent"), n_students,
                           prob = c(0.7, 0.3), replace = TRUE)
)

# Create academic achievement based on REAL factors, not demographics
student_data <- student_data %>%
  mutate(
    # Academic achievement primarily driven by family factors, not demographics
    achievement = 500 + 
      case_when(family_income == "High" ~ 80,
               family_income == "Middle" ~ 40,
               TRUE ~ 0) +
      case_when(parent_education == "College+" ~ 70,
               parent_education == "Some College" ~ 35,
               TRUE ~ 0) +
      case_when(family_structure == "Two Parent" ~ 30,
               TRUE ~ 0) +
      # Add small random demographic effect (much smaller than real factors)
      case_when(demographic == "Red" ~ rnorm(n(), 0, 5),
               demographic == "Green" ~ rnorm(n(), 10, 5),
               TRUE ~ rnorm(n(), 5, 5)) +
      rnorm(n(), 0, 40)  # Individual variation
  )

# Calculate variance components
total_variance <- var(student_data$achievement)

# Variance explained by demographics alone
demo_model <- lm(achievement ~ demographic, data = student_data)
demo_variance <- var(fitted(demo_model))

# Variance explained by real factors
real_factors_model <- lm(achievement ~ family_income + parent_education + family_structure, 
                        data = student_data)
real_factors_variance <- var(fitted(real_factors_model))

# Create variance breakdown
variance_analysis <- data.frame(
  Factor = c("Demographics Only", "Real Family Factors", "Unexplained"),
  Variance_Explained = c(demo_variance/total_variance * 100,
                        real_factors_variance/total_variance * 100,
                        (total_variance - real_factors_variance)/total_variance * 100)
)

knitr::kable(variance_analysis, 
             digits = 1,
             caption = "What Actually Predicts Student Achievement",
             col.names = c("Predictor", "Variance Explained (%)"))

# Show the problem with demographic-only analysis
demo_gaps <- student_data %>%
  group_by(demographic) %>%
  summarise(Mean_Achievement = mean(achievement), .groups = 'drop')

# Show proper analysis within matched groups
matched_analysis <- student_data %>%
  filter(family_income == "Middle", 
         parent_education == "Some College",
         family_structure == "Two Parent") %>%
  group_by(demographic) %>%
  summarise(
    Mean_Achievement = mean(achievement),
    N = n(),
    .groups = 'drop'
  )

# Create visualization showing the difference
p1 <- ggplot(student_data, aes(x = demographic, y = achievement, fill = demographic)) +
  geom_violin(alpha = 0.7) +
  geom_boxplot(width = 0.3, alpha = 0.8) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 4, 
               fill = "white", color = "black") +
  scale_fill_manual(values = c("Red" = "#E74C3C", "Green" = "#27AE60", "Blue" = "#3498DB")) +
  labs(title = "Wrong Analysis: All Students by Demographics",
       subtitle = "Apparent differences between groups",
       x = "Demographic Group", y = "Achievement Score") +
  theme(legend.position = "none")

# Filter for matched groups
matched_students <- student_data %>%
  filter(family_income == "Middle", 
         parent_education == "Some College",
         family_structure == "Two Parent")

p2 <- ggplot(matched_students, aes(x = demographic, y = achievement, fill = demographic)) +
  geom_violin(alpha = 0.7) +
  geom_boxplot(width = 0.3, alpha = 0.8) +
  stat_summary(fun = mean, geom = "point", shape = 23, size = 4, 
               fill = "white", color = "black") +
  scale_fill_manual(values = c("Red" = "#E74C3C", "Green" = "#27AE60", "Blue" = "#3498DB")) +
  labs(title = "Correct Analysis: Matched Students Only",
       subtitle = "Differences largely disappear when comparing similar students",
       x = "Demographic Group", y = "Achievement Score") +
  theme(legend.position = "none")

# Display both plots
p1
p2

# Show the variance breakdown as a bar chart
ggplot(variance_analysis, aes(x = Factor, y = Variance_Explained, fill = Factor)) +
  geom_col(alpha = 0.8, width = 0.7) +
  scale_fill_manual(values = c("Demographics Only" = "#E74C3C",
                              "Real Family Factors" = "#27AE60", 
                              "Unexplained" = "#95A5A6")) +
  labs(title = "What Really Drives Academic Achievement?",
       subtitle = "Family factors matter far more than demographic categories",
       x = "Predictor Variables", 
       y = "Percentage of Variance Explained",
       caption = "Yet most equity research focuses only on demographics") +
  theme(legend.position = "none",
        axis.text.x = element_text(angle = 45, hjust = 1)) +
  geom_text(aes(label = paste0(round(Variance_Explained, 1), "%")), 
            vjust = -0.5, size = 4, fontface = "bold") +
  ylim(0, max(variance_analysis$Variance_Explained) * 1.1)
```

#### Questions Rational Subgrouping Would Answer

1. **Do racial gaps persist when comparing students with:**
   - Same family income?
   - Same parental education?
   - Same family structure?
   - Same prior preparation?
   - Same school quality?

2. **Is the variation WITHIN racial groups larger than BETWEEN racial groups?**

3. **Do high-performing students cluster together regardless of race?**

4. **What factors actually predict academic success?**

### Working Within Government Data Constraints

::: {.callout-tip}
## Practical Guidance for Researchers

Even when stuck with government-defined categories, you can still practice good science:
:::

#### Step 1: Acknowledge the Limitation
```r
# Document that categories may not be scientifically meaningful
# "Race categories as defined by federal reporting requirements 
#  may not reflect meaningful biological or cultural distinctions"
```

#### Step 2: Test Category Validity
- Are government-defined subgroups actually homogeneous on relevant variables?
- Do the categories predict outcomes better than alternative groupings?
- What happens when you subdivide the categories further?

```r
# Example: Test if "Hispanic" category is meaningful
hispanic_variance <- var(outcomes[ethnicity == "Hispanic"])
within_group_variance <- var(outcomes[country_of_origin == "Mexico"]) + 
                        var(outcomes[country_of_origin == "El Salvador"]) # etc.
```

#### Step 3: Control for Observable Confounds
Even with limited data, control for what you can:

```r
# Minimum controls for any group comparison study
model <- lm(outcome ~ group + 
           socioeconomic_status + 
           prior_achievement + 
           family_structure + 
           school_characteristics +
           geographic_controls)
```

#### Step 4: Sensitivity Analysis
Test whether results depend on specific categorizations:

```r
# Test multiple grouping schemes
results_by_race <- analyze_gaps(group_by = "race")
results_by_ses <- analyze_gaps(group_by = "socioeconomic_quintile") 
results_by_school <- analyze_gaps(group_by = "school_quality")

# If results change dramatically, the "race effect" may be spurious
```

#### Step 5: Heterogeneity Analysis
Government categories often hide important variation:

```r
# Don't just report "Black-White gap"
# Report gaps by:
# - Immigrant status within racial groups
# - SES within racial groups  
# - Geographic region within racial groups
# - Family structure within racial groups
```

### Red Flags for "Data Mining" vs. Hypothesis Testing

#### Scientific Hypothesis Testing:
- ✓ Hypotheses stated **before** analyzing data
- ✓ Predictions about **direction and magnitude** of effects
- ✓ Analysis plan **pre-registered**
- ✓ Negative results **reported honestly**

#### Data Mining Masquerading as Science:
- ✗ "Exploring the data to see what we find"
- ✗ Running dozens of tests until something is "significant"
- ✗ Changing hypotheses after seeing results
- ✗ Only reporting "successful" findings

### Minimum Standards for Observational Equity Research

Even with government datasets, researchers should:

1. **Pre-specify** what size effect would be practically meaningful
2. **Control** for obvious confounding variables  
3. **Test** whether effects are robust to different specifications
4. **Report** confidence intervals, not just p-values
5. **Discuss** alternative explanations for findings
6. **Replicate** on different datasets/time periods if possible

::: {.callout-important}
## The Bottom Line for Observational Data

You cannot establish causation from observational data alone, but you can still practice rigorous descriptive science by acknowledging limitations, controlling for confounds, and testing robustness of findings.
:::

## The Current Pseudo-Scientific Approach

Instead of proper methodology, current "equity research" follows this pattern:

1. **Assume** group differences = discrimination
2. **Collect data** confirming the assumption  
3. **Implement interventions** based on assumptions
4. **Declare success** regardless of actual outcomes

## Medical Research Analogy

Imagine if pharmaceutical companies could:

- ✗ Assume their drug works without testing
- ✗ Only test on people likely to improve anyway  
- ✗ Ignore side effects
- ✗ Skip control groups
- ✗ Get FDA approval based on "equity" rather than efficacy

**Result:** Public health catastrophe

**Current Reality:** This is exactly the methodology being used to reshape education policy affecting millions of children.

## Practical Checklist for Researchers Using Government Datasets

### Before You Start Analysis

- [ ] **Define hypotheses clearly** - What specific claims are you testing?
- [ ] **Specify effect sizes** - How large a difference would be meaningful?
- [ ] **Identify confounds** - What other variables could explain group differences?
- [ ] **Plan rational subgrouping** - How will you ensure comparable groups?
- [ ] **Plan sensitivity tests** - How will you check if results are robust?

### During Analysis: Rational Subgrouping

- [ ] **Test within-group homogeneity** - How much variation exists within each demographic category?
```r
# Test if government categories are meaningful
black_variance <- var(outcomes[race == "Black"])
within_ses_variance <- var(outcomes[race == "Black" & ses == "high"])
# If within-SES variance is much smaller, SES matters more than race
```

- [ ] **Compare matched subgroups** - Use propensity score matching or similar techniques
- [ ] **Analyze the most comparable individuals** - Not entire demographic categories
- [ ] **Report within-group vs. between-group variation** - Is most variation within or between groups?

### Standard Analysis Checks

- [ ] **Test multiple models** - Do results hold with different control variables?
- [ ] **Check category validity** - Are government categories internally consistent?
- [ ] **Report effect sizes** - Not just statistical significance
- [ ] **Show confidence intervals** - Acknowledge uncertainty

### Before Publishing/Recommending Policy

- [ ] **Apply the Thomas Sowell test** - Do gaps disappear when comparing truly similar individuals?
- [ ] **Consider alternative explanations** - What else could cause these patterns?
- [ ] **Test on holdout data** - Do results replicate on independent samples?
- [ ] **Discuss limitations honestly** - What can't your study tell us?
- [ ] **Avoid causal language** - Use "associated with" not "caused by"

### Red Flag Questions for Data Mining

Ask yourself honestly:

1. **Did I decide what to look for before looking at the data?**
2. **How many different analyses did I try before getting this result?**
3. **Would I be willing to bet money that this result will replicate?**
4. **Am I controlling for the most obvious alternative explanations?**
5. **Am I comparing truly comparable individuals or just demographic categories?**
6. **Is most of the variation within groups or between groups?**

If you can't answer these satisfactorily, you're probably data mining rather than hypothesis testing.

## Conclusions

The current approach to educational equity research violates fundamental principles of scientific investigation:

1. **No hypothesis testing** of core assumptions
2. **No control for confounding variables**
3. **No proper control groups**
4. **No accounting for natural variation**
5. **No replication requirements**
6. **Policy implementation without evidence**
7. **No rational subgrouping** - comparing demographic categories rather than comparable individuals

::: {.callout-note}
## The Thomas Sowell Principle

Whether examining educational outcomes or medical doctor salaries, Sowell's analysis demonstrates that apparent group differences often disappear when comparing truly comparable individuals rather than broad demographic categories.

**Educational Example:** High-performing students of all races often have more in common with each other than with low-performing members of their own racial group.

**Medical Example:** Never-married female doctors with no career breaks earn the same (or more) than comparable male doctors.
:::

**The Fundamental Question:** Are we measuring discrimination or are we measuring the effects of different life choices, preparation levels, and cultural factors that happen to correlate with demographic categories?

A genuinely scientific approach would disaggregate data until comparison groups are truly comparable, not stop at convenient government-defined categories.

---
title: "Most Education Research is ***NOT*** Science"
subtitle: "When Ideology Masquerades as Scientific Inquiry"
bibliography: manual-refs.bib
authors: 
  - name: "Dan Swart, CPA (ret)"
  - name: "Claude Sonnet 4.5"
date: today
date-format: long
# bibliography: manual-refs.bib
format:
  html:
    resources:
      - reference-backlinks.js
    include-after-body:    
      - text: |
          # <script type="text/javascript" src="reference-backlinks.js"></script>
    default: true         
    code-copy: true
    code-link: true        # This adds individual buttons
    code-fold: true        # Hide code by default, show on click
    code-summary: "Show the code"
    code-overflow: wrap
    code-block-bg: "#FAEBD7"
    code-block-border-left: "#31BAE9"
    embed-resources: true
    include-in-header:
      - text: 
          <link href="https://fonts.googleapis.com/css2?family=Lato&display=swap" rel="stylesheet">
          <link href="https://fonts.googleapis.com/css2?family=Fira+Mono&display=swap" rel="stylesheet">
          <link href="https://fonts.googleapis.com/css2?family=Montserrat&display=swap" rel="stylesheet">
          <link href="https://fonts.googleapis.com/css2?family=Cabin&display=swap" rel="stylesheet">
          <link href="https://fonts.googleapis.com/css2?family=Roboto+Slab&display=swap" rel="stylesheet">
          <link href="https://fonts.googleapis.com/css2?family=Schoolbell&display=swap" rel="stylesheet">
      - header.html
    css:
      - swart.css
      - tachyons.min.css
      - r-colors.css
    fontsize: 18pt
    lightbox: true
    page-layout: full
    fig-width: 12
    fig-height: 10
    fig-dpi: 300
    html-math-method: katex
    df-print: paged
    toc: true
    toc-float: true
    citeproc: true
    link-citations: true
    linestretch: 1.0
    
    
    
  typst:
    fig-width: 12
    fig-height: 10
    fig-dpi: 300
    margin:
      x: 1in
      y: 1in
    toc: true
    fontsize: 16pt
    mainfont: "Cabin"
  
    
  revealjs:
    slide-number: true
    transition: fade
    code-overflow: wrap
    center: true
    smaller: true
    scrollable: true
    chalkboard: true
    multiplex: false
    theme: solarized
    reference-location: margin
    logo: img/red-cross-640-435.png
    footer: "Footer text"
    code-block-height: 650px



  # docx:
  #   highlight-style: github
  #   fig_caption: true



editor: source

quarto:
  render:
    cache-refresh: true


# for .qmd filesd
execute:
  echo: true
  message: false
  warning: false
  eval: true
  fig-width: 12
  fig-height: 10


# for .rmd files
knitr:
  opts_chunk:
    echo: true
    error: false
    warning: false
    message: false
    cache: false


---


```{r}
#| label: setup
#| include: false


# install.packages(c("mapview", "survey", "srvyr", "arcgislayers"))

# census_api_key("95496766c51541ee6f402c1e1a8658581285b759", install = TRUE, overwrite = TRUE)


# # load libraries - NOT NEEDED


# Force dplyr's select to take precedence
select <- dplyr::select
filter <- dplyr::filter

# Options
options(scipen = 999)
options(qic.clshade = T) # NO LONGER NEEDED; CHARTS ALL PREPARED WITH GGPLOT2 ONLY
options(qic.linecol = 'black') # NO LONGER NEEDED; CHARTS ALL PREPARED WITH GGPLOT2 ONLY
options(qic.signalcol = "firebrick") # NO LONGER NEEDED; CHARTS ALL PREPARED WITH GGPLOT2 ONLY
options(qic.targetcol = "purple") # NO LONGER NEEDED; CHARTS ALL PREPARED WITH GGPLOT2 ONLY
options(DT.options = list(dom = 'pBlfrti')) # Add buttons, filtering, and top (t) pagination controls
options(shiny.maxRequestSize = 50 * 1024^2) # Set upload maximum to 50 MB
options(tigris_use_cache = TRUE)


flextable::set_flextable_defaults(
  font.size = 14, 
  font.family = "Cabin",
  font.color = "black",
  table.layout = "fixed",
  border.color = "darkgray",
  padding.top = 3, padding.bottom = 3,
  padding.left = 4, padding.right = 4,
  line_spacing = 1.3,
  digits = 2,
  decimal.mark = ",",
  big.mark = " ",
  na_str = "<na>"
  )


# Set global theme for consistent plots
ggplot2::theme_set(
  ggplot2::theme_minimal(base_size = 20) +
    ggplot2::theme(
      plot.title.position = "plot",
      plot.title = ggtext::element_textbox_simple(
        family = "Cabin",
        face = "bold",
        color = "darkgreen",
        size = 22,
        fill = "yellow",
        lineheight = 1.0,
        padding = ggplot2::margin(5.5, 5.5, 0.0, 5.5),
        margin = ggplot2::margin(0, 0, 5.5, 0)
      ),
      plot.subtitle = ggtext::element_textbox_simple(
        family = "Cabin",
        color = "darkgreen",
        face = "bold",
        size = 20,
        fill = "yellow",
        lineheight = 1.0,
        padding = ggplot2::margin(0.0, 5.5, 5.5, 5.5),
        margin = ggplot2::margin(0, 0, 5.5, 0)
      ),
      plot.caption = ggtext::element_markdown(
        family = "Cabin",
        size = 16,
        hjust = 1,
        color = "darkblue",
        face = "italic",
        fill = "yellow",
        lineheight = 1.0
      ),
      axis.text.x = ggtext::element_markdown(
        family = "Cabin",
        face = "bold",
        color = "blue",
        size = 16,
        angle = 45,
        hjust = 1
      ),
        # ggplot2::element_blank(),
      axis.title.x = ggtext::element_markdown(
        family = "Cabin",
        face = "bold",
        color = "blue",
        size = 16),
        # ggplot2::element_blank(),
      axis.text.y = ggtext::element_markdown(
        family = "Cabin",
        face = "bold",
        color = "blue",
        size = 16,
        angle = 45,
        hjust = 1
      ),
        # ggplot2::element_blank(),
      axis.title.y = ggtext::element_markdown(
        family = "Cabin",
        face = "bold",
        color = "blue",
        size = 16),
        # ggplot2::element_blank(),
      strip.text = ggtext::element_markdown(
        family = "Cabin",
        color = "black",
        size = ggplot2::rel(1.1),
        face = "italic",
        margin = ggplot2::margin(2, 0, 0.5, 0, "lines")
      ),
      axis.text = ggtext::element_markdown(
        family = "Cabin",
        color = "black"),
      panel.background = ggplot2::element_rect(fill = "white", color = NA),
      plot.background = ggplot2::element_rect(fill = "white", color = NA),
      legend.position = "none",
      panel.spacing.x = grid::unit(1.5, "cm"),
      panel.spacing.y = grid::unit(1.5, "cm"),
      plot.margin = ggplot2::margin(20, 20, 20, 20, "pt")
    )
)



  
# Set seed for reproducibility
set.seed(123)

```



# A Cautionary Tale About Scientific Analysis of Educational Claims

::: {.my-quote}
***"When you want to help people you tell them the truth. When you want to help yourself, you tell them what they want to hear."*** ~ Thomas Sowell
:::

::: {.my-quote}
***"[For the social scientist researcher...] the justification for drawing causation from a correlation model is saying our theory has all the causality built in. We don't need to infer the causality from the data. We have the causality and it is well known; it's a given. All we need the statistical model for is quantifying the effects."*** — Galit Schmueli - statistician, describing the social scientists' approach (New England Symposium, 2010)
:::





## Data Mining vs. Scientific Research

### Data Mining Alone (Not Scientific Research)

- Pattern hunting: Looking through data without pre-specified hypotheses  
- P-hacking: Testing multiple relationships until finding "significant" results  
- No theoretical framework: Purely empirical pattern detection  
- No replication: Findings may not generalize beyond the specific dataset  
- Multiple comparisons problem: Testing hundreds of relationships increases false discoveries  


### Data Mining as Part of Scientific Research

- Replication: Validating findings on independent datasets  
- Hypothesis generation: Using patterns to formulate testable hypotheses  
- Exploratory analysis: Initial data exploration guided by theory  
- Followed by confirmation: Testing generated hypotheses on new data  
- Proper statistical controls: Adjusting for multiple comparisons  


### The Scientific Method Requirements

For research to be scientific, it must include:

#### Scientific approach

1. Theoretical framework
2. Pre-specified hypotheses  
3. Proper controls
4. Replication
5. Peer review
6. Transparency

#### Data mining approach

1. Explore data patterns
2. Test multiple relationships
3. Report "significant" findings
4. No independent validation
5. Limited theoretical basis


### Examples

#### Data Mining Masquerading as Science

#### This is NOT scientific research:

education_data ->  

* Test many multiples of demographic comparisons  
* Group by every possible subgroup and compare to 'population' percentages
* Summarize and apply tests of significance to all of them  
* Report only the "significant" ones  
* Claim these represent "discrimination"  
* Conclude "bias exists"  
  


### Legitimate Scientific Use of Data Mining

#### This CAN be scientific:

#### Phase 1: Exploratory (data mining)

Analyze for potential_patterns:

  education_data ->  
  explore_patterns ->  
  generate_hypotheses for testing


#### Phase 2: Confirmatory (scientific testing)

test_specific_hypothesis:

  hypothesis = "SES predicts achievement better than demographics", 
  include controls 
    family attitudes toward education
    family_structure
    prior_achievement
    etc.
  


### Guidelines for Legitimate Use

#### When Data Mining Can Be Scientific:

- Hypothesis generation phase clearly separated from testing phase  
- Pre-registration of analysis plans  
- Multiple comparison corrections applied  
- Replication on independent datasets  
- Theoretical framework guiding interpretation  
- Transparency about exploratory vs. confirmatory analyses  


#### Red Flags for Non-Scientific Data Mining:

- Testing many relationships without controlling for multiple comparisons  
- Changing hypotheses after seeing results  
- Only reporting "significant" findings  
- No theoretical justification for analyses  
- Claims of causation from correlational patterns  
- No attempt at replication  





## Abstract

An earnest discussion of poor research methods in current educational research, including 'equity' claims;  contrasts rigorous scientific methodologies with current practice when investigating group differences in academic results. The astonishing fact is that most of the important research questions are never presented, or even asked for.







## A Problematic Claim

We begin with an example frim a textbook designed to teach data 'scientists' how to examine data using pseudo-scientific methods, searching for evidence demonstrating institutional racism:

> "For example, one way for school systems to support efforts towards equity in student results is to frequently examine any differences in results among student subgroups (Chapter 3)." [@bovee2024data]

This statement comes early in the book and is repeated elsewhere.  It starts with an **unproven assumption:** that group differences from population demographic percentages inherently indicate systemic bias requiring intervention.



## Trouble from the Outset


::: {.callout-warning}
## The Government Data Problem

Government data is collected for the purpose of punishment and reward.  For funding based on numbers of students in various categories, as well as rating and ranking everyone and their uncles.  Comparing school districts with each other (for rating and ranking).  This data for enumeration studies (how many or how much, regardless of why categories differ).  It is not collected for research purposes.

Research useful to education practitioners comes from analytic studies; studies that differentiate between the results that come from individuals in the system, and results that come from the system itself (common and special causes).  That type of study is absent from education research.

Most social science researchers work with datasets generated by government, or other quasi-government institutions.  They us government-specified subgroups rather than rationally selected variables for experimental validity. This creates enormous systematic bias in research design from the outset.  Subgroups rarely have the screening variables needed to minimize variance withing group. 


**Additional Complications:**

- **Self-designation**: Individuals can choose their own categories; no outside verification of correct classification

- **Multiple categories**: People can belong to more than one subgroup

- **Assumed homogeneity**: Massive within-group differences are ignored
:::


::: {.callout-note}
All exammples of subgrouping in this paper use the categories of 'red', 'green', and 'blue' - which should remove the political/emotional content that feeds much of this type of research.  It is the methodology that counts.
:::


## Distinguishing Experimental vs. Observational Research

Nearly all education research is based on observational studies.  To be rigorous much greater care and planning is required.

There are experimental studies taking place in education reserch.  The What Works Clearinghouse is the best source of finding such studies.  The requirements to be accepted for review are rigorous and require experimental design (either with experimental data, or observational data). 

I have yet to run into anyone in the K-12 delivery system in Texas that has even heard of the website or its study review requirements.  Certainly, the claims regarding 'equity', 'diversity' or 'school board affects on student achievement' will never be found there.  Those types of 'studies' would not even qualify for review.

### Experimental Data: Ideal Scientific Approach

When researchers can control variables and assign treatments randomly. (Or, when causal mechanisms can be simulated with observational data based on  causal analysis (e.g., DAGs).

### Observational Data: Constrained but Can Still Be Scientific

When working with existing datasets (most social science research), rigorous methodology becomes even more important.


---

## How Skilled Scientists Would Investigate This Claim

### Step 1: Question the Fundamental Premises

**Scientific Approach:**

- What credible evidence supports the assumption that group differences in results indicate systemic bias? Appeals to authorities must be examined carefully.
- Under what conditions would group differences be expected even in perfectly fair systems?
- Are we conflating correlation with causation?

**Current "Equity" Research Practice:**

- Treats premises as axiomatic
- No testing of underlying assumptions
- Direct jump to data collection
- Since causation is within the premises, data analysis is only present to measure the effects of the presumed causal premises.   Empirical verification is unnecessary.

---

### Step 2: Form Multiple Competing Hypotheses

A proper scientific investigation would generate testable hypotheses:

```{r}
#| label: hypotheses-table

hypotheses_data <- base::data.frame(
  Hypothesis = base::c("H₁: Discrimination", "H₂: Preparation/Effort", "H₃: Random Variation", "H₄: External Factors"),
  Description = base::c(
    "Differences reflect measurement bias or systemic discrimination",
    "Differences reflect genuine performance variations due to preparation, effort, or prior knowledge",
    "Differences reflect normal statistical variation within acceptable bounds",
    "Differences reflect cultural/family factors unrelated to school policy"
  ),
  Prediction = base::c(
    "Differences should persist even when controlling for relevant variables",
    "Differences should correlate with measurable preparation factors",
    "Differences should fall within expected confidence intervals",
    "School interventions should have minimal impact on these differences"
  ),
  Testable = base::c("Yes", "Yes", "Yes", "Yes")
)

DT::datatable(hypotheses_data, 
              caption = "Competing Hypotheses for Group Differences in Academic results",
              options = list(pageLength = 10, scrollX = TRUE),
              rownames = FALSE) |>
  DT::formatStyle(columns = base::colnames(hypotheses_data), fontSize = '14px')
```

---

### Step 3: Address Confounding Variables

::: {.callout-warning}
## Critical Issue: Rational Subgrouping

Current equity research fails to address whether compared groups are actually comparable.
:::

```{r}
#| label: confounding-variables

confounding_vars <- base::data.frame(
  Variable = base::c("Socioeconomic status", "Family structure", "Time spent on homework", 
               "Attendance rates", "Language spoken at home", "Prior educational preparation",
               "Cultural attitudes toward education", "Peer influences", "School quality"),
  Measurement = base::c("Family income, parent education", "Two-parent vs single-parent", 
                  "Hours per week", "Days present/total days", "Primary language",
                  "Previous test scores, coursework", "Survey responses", 
                  "Friend academic performance", "Teacher quality, resources"),
  Impact_on_Validity = base::c("High", "High", "Medium", "Medium", "High", "High", "High", "Medium", "High")
)

DT::datatable(confounding_vars,
              caption = "Critical Confounding Variables Often Ignored in Equity Research",
              options = list(pageLength = 10, scrollX = TRUE),
              rownames = FALSE) |>
  DT::formatStyle("Impact_on_Validity", 
                  backgroundColor = DT::styleEqual(base::c("High", "Medium"), 
                                                   base::c("#ffcccc", "#ffffcc")))
```

**Questions to Address:**
- Are we comparing truly comparable groups?
- What obvious explanatory variables are being ignored?
- How do we separate correlation from causation?

---

### Step 4: Establish Proper Experimental Controls

**Control Group Requirements:**
- Schools with similar demographics but different "equity" interventions
- Baseline measurements before any interventions
- Matched comparison groups

**Current Problems:**
- No control groups
- No baseline measurements
- No independent variables isolated

---

### Step 5: Account for Statistical Variation

::: {.callout-important}
## Statistical Reality

Differences will **ALWAYS** exist between any groups measured at any time, even between the same individuals tested at different times of day.
:::

```{r}
#| label: statistical-variation-demo
#| fig-cap: "Normal Statistical Variation Between Groups"

# Simulate test scores for demonstration
base::set.seed(42)
n_students <- 1000

# Create random groups - no systematic differences
group_assignment <- base::sample(base::c("Red", "Green", "Blue"), n_students, replace = TRUE)
base_scores <- stats::rnorm(n_students, mean = 1200, sd = 200)

# Add tiny random group effects (noise)
group_effects <- base::c(n_students)
group_effects[group_assignment == "Red"] <- stats::rnorm(base::sum(group_assignment == "Red"), 0, 10)
group_effects[group_assignment == "Green"] <- stats::rnorm(base::sum(group_assignment == "Green"), 0, 10)
group_effects[group_assignment == "Blue"] <- stats::rnorm(base::sum(group_assignment == "Blue"), 0, 10)

final_scores <- base_scores + group_effects

demo_data <- base::data.frame(
  Group = group_assignment,
  Score = final_scores
)

# Create visualization - density plots
p1 <- ggplot2::ggplot(demo_data, ggplot2::aes(x = Score, fill = Group)) +
  ggplot2::geom_density(alpha = 0.7) +
  ggplot2::facet_wrap(~Group, ncol = 3) +
  ggplot2::scale_fill_manual(values = base::c("Red" = "#FF6B6B", "Green" = "#51CF66", "Blue" = "#74C0FC")) +
  ggplot2::labs(title = "Statistical Variation in Randomly Assigned Groups",
       subtitle = "Groups differ despite NO systematic treatment differences",
       x = "Test Score",
       y = "Density") +
  ggplot2::geom_vline(data = demo_data 
                      |> dplyr::group_by(Group) 
                      |> dplyr::summarise(mean_score = base::mean(Score)),
             ggplot2::aes(xintercept = mean_score), linetype = "dashed", color = "black", size = 1)

base::print(p1)

# Summary statistics
summary_stats <- demo_data |>
  dplyr::group_by(Group) |>
  dplyr::summarise(
    Mean = base::round(base::mean(Score), 1),
    SD = base::round(stats::sd(Score), 1),
    N = dplyr::n(),
    .groups = 'drop'
  )

DT::datatable(summary_stats,
              caption = "Group Differences That Exist Due to Random Chance Alone",
              options = list(dom = 't'),
              rownames = FALSE)

```

**Scientific Questions:**
- What magnitude of difference is statistically significant?
- What falls within normal variation?
- Are we chasing statistical noise?
- What are the confidence intervals?

---

### Step 6: Replication and Peer Review

**Scientific Standards:**
- Independent replication by other researchers
- Peer review of methodology
- Open data and reproducible analysis
- Pre-registration of hypotheses

**Current State:**
- Minimal independent replication
- Methodology rarely scrutinized
- Results assumed rather than tested

---

## Methodology Matrix: Experimental vs. Observational Data

### Steps Required for BOTH Experimental and Observational Studies

```{r}
#| label: methodology-matrix

methodology_matrix <- base::data.frame(
  Step = base::c("Question Core Assumptions", "Multiple Competing Hypotheses", 
           "Account for Statistical Variation", "Proper Statistical Testing"),
  Experimental_Data = base::c("✓ Essential", "✓ Standard practice", "✓ Required", "✓ Standard"),
  Observational_Data = base::c("✓ **CRITICAL** - Only way to avoid bias", 
                        "✓ **EVEN MORE Important** - Can't test assumptions directly",
                        "✓ **EVEN MORE Critical** - Higher risk of noise",
                        "✓ **Enhanced Methods** - Need robustness checks")
)

DT::datatable(methodology_matrix,
              caption = "Methodological Requirements by Study Type",
              options = list(dom = 't', scrollX = TRUE),
              rownames = FALSE,
              escape = FALSE)

```

---

### Steps That Differ Between Study Types

#### For Experimental Data (Rare in Social Science)

- **Random Assignment**: Researcher controls who gets treatment
- **Manipulation of Variables**: Can isolate causal mechanisms  
- **Direct Causation Testing**: Can establish cause-effect relationships
- **Controlled Environment**: Minimize confounding factors

#### For Observational Data (Most Social Science)

- **Quasi-Experimental Design**: Find "natural experiments"
- **Instrumental Variables**: Use external factors that affect treatment assignment
- **Regression Discontinuity**: Exploit arbitrary cutoffs in policy
- **Difference-in-Differences**: Compare changes over time between groups

---

## The Mathematical Foundations: Why Current Approaches Are Statistically Invalid

::: {.callout-critical}
## Fundamental Statistical Assumption Violation

All analytical statistics comparing groups rely on the mathematical requirement that **within-group variance should be small relative to between-group variance**. Current equity research systematically violates this assumption, rendering the statistical results mathematically meaningless.
:::

### The Mathematical Requirements for Valid Group Comparisons

For any comparative statistical analysis (ANOVA, t-tests, regression with categorical variables) to be valid:

**σ²(within) << σ²(between)**

Where:
- σ²(within) = variance within each group
- σ²(between) = variance between group means

#### When the Assumption is Violated

```{r}
#| label: variance-violation-demo
#| fig-cap: "Within-Group vs Between-Group Variance Problem"

# Example: Current educational equity research
base::set.seed(123)
red_students <- base::c(300, 850, 1200, 1540, 1580)  # SAT scores within "Red" category
blue_students <- base::c(400, 900, 1300, 1520, 1600)  # SAT scores within "Blue" category

within_group_var <- stats::var(red_students) + stats::var(blue_students)  # Massive
between_group_var <- stats::var(base::c(base::mean(red_students), base::mean(blue_students)))  # Small

variance_comparison <- base::data.frame(
  Variance_Type = base::c("Within-group variance", "Between-group variance", "Ratio (within/between)"),
  Value = base::c(within_group_var, between_group_var, within_group_var / between_group_var),
  Interpretation = base::c("Huge variation within demographic groups",
                    "Small difference between group averages", 
                    "Statistical analysis becomes invalid")
)

DT::datatable(variance_comparison,
              caption = "Variance Decomposition: Why Group Comparisons Are Invalid",
              options = list(dom = 't'),
              rownames = FALSE) |>
  DT::formatRound(columns = 'Value', digits = 1)

# Visualize the problem
demo_data_detailed <- base::data.frame(
  Group = base::rep(base::c("Red", "Blue"), each = 5),
  Score = base::c(red_students, blue_students),
  Student_ID = 1:10
)

p2 <- ggplot2::ggplot(demo_data_detailed, ggplot2::aes(x = Group, y = Score, color = Group)) +
  ggplot2::geom_point(size = 4, alpha = 0.8) +
  ggplot2::geom_line(ggplot2::aes(group = 1), stat = "summary", fun = mean, size = 2, color = "black") +
  ggplot2::stat_summary(fun = mean, geom = "point", size = 6, color = "black") +
  ggplot2::scale_color_manual(values = base::c("Red" = "#FF6B6B", "Blue" = "#74C0FC")) +
  ggplot2::labs(title = "Massive Within-Group Variation Makes Between-Group Comparison Invalid",
       subtitle = "Individual scores vary more within groups than between group averages",
       x = "Demographic Group",
       y = "Test Score") +
  ggplot2::annotate("text", x = 1.5, y = 1400, 
           label = "Group means differ by ~60 points\nbut individuals within groups\nvary by >1000 points", 
           size = 5, fontface = "bold")

base::print(p2)
```

### The F-Ratio Problem

In ANOVA, the F-statistic is calculated as:

**F = MS(between) / MS(within)**

When within-group variance is enormous (heterogeneous groups), the denominator inflates, making F-ratios artificially small and potentially masking real effects OR creating spurious effects depending on how the groups are constructed.

---

#### Real-World Consequences

```{r}
#| label: heterogeneous-groups-demo
#| fig-cap: "Heterogeneous Group Problem in Educational Research"

# "Red students" category might include:
base::set.seed(456)
high_achieving_subgroup <- stats::rnorm(50, mean = 1450, sd = 50)    # High-achieving
middle_class_subgroup <- stats::rnorm(100, mean = 1275, sd = 100)    # Middle-class  
disadvantaged_subgroup <- stats::rnorm(75, mean = 400, sd = 80)      # Low-resourced

# Create detailed data
subgroup_labels <- base::c(base::rep("High-achieving Red", 50),
                    base::rep("Middle-class Red", 100), 
                    base::rep("Disadvantaged Red", 75))

all_red_students <- base::c(high_achieving_subgroup, middle_class_subgroup, disadvantaged_subgroup)

heterogeneous_demo <- base::data.frame(
  Subgroup = subgroup_labels,
  Score = all_red_students,
  MainGroup = "Red Students"
)

# Calculate variances
within_red_variance <- stats::var(all_red_students)
within_subgroup_variances <- heterogeneous_demo |>
  dplyr::group_by(Subgroup) |>
  dplyr::summarize(Variance = stats::var(Score), .groups = 'drop')

p3 <- ggplot2::ggplot(heterogeneous_demo, ggplot2::aes(x = Score, fill = Subgroup)) +
  ggplot2::geom_density(alpha = 0.7) +
  ggplot2::facet_wrap(~Subgroup, ncol = 2, scales = "free_y") +
  ggplot2::scale_fill_manual(values = base::c("#FF9999", "#FF6666", "#FF3333")) +
  ggplot2::labs(title = "The 'Red Students' Category Contains Multiple Distinct Populations",
       subtitle = "Treating this as one group violates statistical assumptions",
       x = "Test Score",
       y = "Density"
       )

base::print(p3)

# Summary table
variance_breakdown <- base::data.frame(
  Analysis_Level = base::c("All Red Students Combined", "High-achieving Red", "Middle-class Red", "Disadvantaged Red"),
  N = base::c(225, 50, 100, 75),
  Mean = base::c(base::round(base::mean(all_red_students), 1),
           base::round(base::mean(high_achieving_subgroup), 1),
           base::round(base::mean(middle_class_subgroup), 1), 
           base::round(base::mean(disadvantaged_subgroup), 1)),
  Variance = base::c(base::round(within_red_variance, 1),
               base::round(stats::var(high_achieving_subgroup), 1),
               base::round(stats::var(middle_class_subgroup), 1),
               base::round(stats::var(disadvantaged_subgroup), 1))
)

DT::datatable(variance_breakdown,
              caption = "Why Disaggregation Matters: Variance Within 'Red' Category",
              options = list(dom = 't'),
              rownames = FALSE) |>
  DT::formatStyle("Variance", 
                  backgroundColor = DT::styleInterval(base::c(10000, 50000), 
                                                      base::c("#90EE90", "#FFFF99", "#FFB6C1")))

```

---

### The Women's Health Initiative Scandal

A perfect medical example of the same mathematical errors:

**WHI Study Design:**
- **"Women" category**: Ages 50-79 (heterogeneous)
- **Treatment**: Hormone therapy vs. placebo
- **Error**: Massive within-group age variance

```{r}
#| label: whi-parallel

# Simulated HRT effect by age (based on actual WHI findings)
ages <- 50:79
hrt_effect <- ifelse(ages <= 60, 
                    stats::rnorm(base::length(ages[ages <= 60]), mean = 0.2, sd = 0.1),  # Beneficial for younger
                    stats::rnorm(base::length(ages[ages > 60]), mean = -0.3, sd = 0.1))  # Harmful for older

whi_demo <- base::data.frame(
  Age = ages,
  HRT_Effect = hrt_effect,
  Age_Group = ifelse(ages <= 60, "Younger Women (50-60)", "Older Women (61-79)")
)

p4 <- ggplot2::ggplot(whi_demo, ggplot2::aes(x = Age, y = HRT_Effect, color = Age_Group)) +
  ggplot2::geom_point(size = 3, alpha = 0.8) +
  ggplot2::geom_smooth(method = "lm", se = TRUE) +
  ggplot2::geom_hline(yintercept = 0, linetype = "dashed", color = "black") +
  ggplot2::scale_color_manual(values = base::c("#FF6B6B", "#74C0FC")) +
  ggplot2::labs(title = "Women's Health Initiative: Why Age Disaggregation Mattered",
       subtitle = "HRT beneficial for younger women, harmful for older women",
       x = "Age",
       y = "HRT Effect (positive = beneficial)",
       color = "Age Group") +
  ggplot2::annotate("text", x = 55, y = 0.3, label = "Beneficial\nEffect", fontface = "bold") +
  ggplot2::annotate("text", x = 70, y = -0.4, label = "Harmful\nEffect", fontface = "bold")

base::print(p4)

# Summary by age group
whi_summary <- whi_demo |>
  dplyr::group_by(Age_Group) |>
  dplyr::summarize(
    Mean_Effect = base::round(base::mean(HRT_Effect), 3),
    N_Ages = dplyr::n(),
    Conclusion = ifelse(base::mean(HRT_Effect) > 0, "HRT Beneficial", "HRT Harmful"),
    .groups = 'drop'
  )

DT::datatable(whi_summary,
              caption = "HRT Effects by Age Group: Importance of Disaggregation",
              options = list(dom = 't'),
              rownames = FALSE)

```

**Mathematical Reality:**
- **"Women" overall**: HRT appears harmful (averaging beneficial and harmful effects)
- **Younger women (50-60)**: HRT beneficial
- **Older women (61-79)**: HRT harmful

**Corrected Analysis:** Proper dis-aggregation by age revealed the truth.


### Statistical Consequences of Heterogeneous Groups

#### 1. Unreliable Effect Sizes
Cohen's d and other effect size measures become meaningless when groups are heterogeneous.

#### 2. Invalid Confidence Intervals
Standard error calculations assume homogeneous groups.

#### 3. Type I and Type II Error Inflation
- **Type I**: Finding false differences due to arbitrary grouping
- **Type II**: Missing real differences due to noise from heterogeneous groups


### The Homogeneity Test Requirement

```{r}
#| label: homogeneity-tests

# Example homogeneity test results for educational data
homogeneity_results <- base::data.frame(
  Group_Comparison = base::c("All Red vs All Blue", "All Red vs All Green", "All Blue vs All Green",
                      "High-SES Red vs High-SES Blue", "Low-SES Red vs Low-SES Blue"),
  Levene_Test_p = base::c(0.001, 0.003, 0.002, 0.342, 0.198),
  Groups_Homogeneous = base::c("No", "No", "No", "Yes", "Yes"),
  Valid_Comparison = base::c("No", "No", "No", "Yes", "Yes")
)

DT::datatable(homogeneity_results,
              caption = "Homogeneity Tests: Most Demographic Comparisons Are Invalid",
              options = list(dom = 't'),
              rownames = FALSE) |>
  DT::formatStyle("Valid_Comparison", 
                  backgroundColor = DT::styleEqual(base::c("Yes", "No"), 
                                                   base::c("#90EE90", "#FFB6C1")))
```

Before any group comparison, researchers should test for equal variances. If p < 0.05, groups are not homogeneous and comparison is statistically invalid.

### The Mathematical Reality in Educational Research

```{r}
#| label: variance-decomposition-demo
#| fig-cap: "Variance Decomposition in Educational Data"

# Simulate realistic educational variance structure
base::set.seed(789)
n_total <- 2000

# Create students with various characteristics
student_data <- base::data.frame(
  demographic_group = base::sample(base::c("Red", "Green", "Blue"), n_total, replace = TRUE),
  ses_level = base::sample(base::c("High", "Medium", "Low"), n_total, replace = TRUE, prob = base::c(0.3, 0.4, 0.3)),
  family_structure = base::sample(base::c("Two-parent", "Single-parent"), n_total, replace = TRUE, prob = base::c(0.7, 0.3)),
  parent_education = base::sample(base::c("College+", "High School", "< High School"), n_total, replace = TRUE, prob = base::c(0.4, 0.4, 0.2))
)

# Generate test scores based on SES and family structure (not demographic group)
base_score <- 1200
ses_effect <- dplyr::case_when(
  student_data$ses_level == "High" ~ 200,
  student_data$ses_level == "Medium" ~ 0,
  student_data$ses_level == "Low" ~ -150
)

family_effect <- ifelse(student_data$family_structure == "Two-parent", 50, -30)
education_effect <- dplyr::case_when(
  student_data$parent_education == "College+" ~ 100,
  student_data$parent_education == "High School" ~ 0,
  student_data$parent_education == "< High School" ~ -80
)

# Add small random demographic effect (just noise)
demo_effect <- base::c(n_total)
demo_effect[student_data$demographic_group == "Red"] <- stats::rnorm(base::sum(student_data$demographic_group == "Red"), 0, 20)
demo_effect[student_data$demographic_group == "Green"] <- stats::rnorm(base::sum(student_data$demographic_group == "Green"), 0, 20)
demo_effect[student_data$demographic_group == "Blue"] <- stats::rnorm(base::sum(student_data$demographic_group == "Blue"), 0, 20)

student_data$test_score <- base_score + ses_effect + family_effect + education_effect + demo_effect + stats::rnorm(n_total, 0, 50)

# Calculate variance components
total_variance <- stats::var(student_data$test_score)

# Variance between demographic groups
demo_means <- student_data |> 
  dplyr::group_by(demographic_group) |> 
  dplyr::summarize(mean_score = base::mean(test_score))
between_demo_var <- stats::var(demo_means$mean_score) * (n_total / 3)  # Adjust for group sizes

# Variance within demographic groups  
within_demo_var <- student_data |>
  dplyr::group_by(demographic_group) |>
  dplyr::summarise(group_var = stats::var(test_score)) |>
  dplyr::pull(group_var) |>
  base::mean()

# Calculate percentages
pct_between_demo <- (between_demo_var / total_variance) * 100
pct_within_demo <- (within_demo_var / total_variance) * 100

variance_decomp <- base::data.frame(
  Source = base::c("Between demographic groups", "Within demographic groups", "Residual"),
  Variance = base::c(between_demo_var, within_demo_var, total_variance - between_demo_var - within_demo_var),
  Percentage = base::c(base::round(pct_between_demo, 1), base::round(pct_within_demo, 1), 
                base::round(100 - pct_between_demo - pct_within_demo, 1))
)

DT::datatable(variance_decomp,
              caption = "Typical Variance Decomposition in Educational Data",
              options = list(dom = 't'),
              rownames = FALSE) |>
  DT::formatRound(columns = 'Variance', digits = 0)

# Visualization - histogram with faceting
p5 <- ggplot2::ggplot(student_data, ggplot2::aes(x = test_score, fill = ses_level)) +
  ggplot2::geom_histogram(alpha = 0.7, bins = 30, position = "identity") +
  ggplot2::facet_grid(demographic_group ~ ses_level) +
  ggplot2::scale_fill_manual(values = base::c("High" = "#90EE90", "Medium" = "#FFFF99", "Low" = "#FFB6C1")) +
  ggplot2::labs(title = "Test Scores by Demographic Group and SES Level",
       subtitle = "SES explains much more variance than demographic categories",
       x = "Test Score",
       y = "Count",
       fill = "SES Level")

base::print(p5)
```

This demonstrates that demographic categories typically explain only 10-20% of academic variance, yet policies treat them as the dominant factor.

::: {.callout-important}
## Bottom Line for Statisticians

When within-group variance exceeds between-group variance, you're not measuring group differences - you're measuring the noise created by improper categorization. The statistical analysis becomes mathematically invalid, regardless of sample size or p-values.
:::

## The Fundamental Problem: Rational Subgrouping

::: {.callout-important}
## The Core Issue: Comparing Apples to Oranges

Current equity research fails at the most basic level - it doesn't establish that comparison groups are actually comparable. The fundamental flaw is treating government-defined demographic categories as if they represent homogeneous groups.
:::

#### The Self-Designation Problem

**Current Practice:**
- Individuals self-select demographic categories
- Many belong to multiple categories simultaneously  
- Categories may reflect social identity rather than relevant characteristics
- No verification of category membership

#### The False Homogeneity Assumption

Government categories assume internal similarity that often doesn't exist:

```{r}
#| label: within-group-heterogeneity

# Demonstrate within-group heterogeneity
within_group_demo <- base::data.frame(
  Category = base::rep(base::c("Red Students", "Green Students", "Blue Students"), each = 4),
  Subgroup = base::c(
    "Recent immigrants", "Multi-generational families", "Urban backgrounds", "Rural backgrounds",
    "High SES", "Low SES", "Different cultural traditions", "Different languages", 
    "Two-parent homes", "Single-parent homes", "Different educational histories", "Different peer groups"
  ),
  Characteristics = base::c(
    "Language barriers, cultural adjustment", "Established networks, resources",
    "Different school systems", "Resource limitations",
    "College-educated parents", "First-generation learners", 
    "Varying academic values", "Communication differences",
    "More stability, resources", "Economic stress", 
    "Private vs public schools", "Academic vs non-academic focus"
  )
)

DT::datatable(within_group_demo,
              caption = "Hidden Heterogeneity Within Government-Defined Categories",
              options = list(pageLength = 12, scrollX = TRUE),
              rownames = FALSE)
```

#### The Thomas Sowell Principle: Disaggregate Until Comparable

**The Medical Doctor Example:**

Instead of comparing ALL male doctors to ALL female doctors:

```{r}
#| label: sowell-principle-demo

# Simulated doctor salary data demonstrating Sowell's principle
base::set.seed(101)

# Create detailed doctor data
n_doctors <- 1000
doctor_data <- base::data.frame(
  gender = sample(base::c("Male", "Female"), n_doctors, replace = TRUE, prob = base::c(0.6, 0.4)),
  specialty = sample(base::c("Surgery", "Family Medicine", "Pediatrics", "Radiology"), 
                    n_doctors, replace = TRUE, prob = base::c(0.2, 0.3, 0.25, 0.25)),
  years_experience = sample(1:30, n_doctors, replace = TRUE),
  marital_status = sample(base::c("Married", "Single"), n_doctors, replace = TRUE, prob = base::c(0.7, 0.3)),
  children = sample(0:3, n_doctors, replace = TRUE, prob = base::c(0.3, 0.3, 0.25, 0.15)),
  career_breaks = sample(0:5, n_doctors, replace = TRUE, prob = base::c(0.6, 0.2, 0.1, 0.05, 0.03, 0.02))
)

# Career breaks more common for women with children
female_with_children <- doctor_data$gender == "Female" & doctor_data$children > 0
doctor_data$career_breaks[female_with_children] <- 
  doctor_data$career_breaks[female_with_children] + 
  rpois(base::sum(female_with_children), 1)

# Base salary calculation
base_salary <- 200000
specialty_bonus <- dplyr::case_when(
  doctor_data$specialty == "Surgery" ~ 150000,
  doctor_data$specialty == "Radiology" ~ 100000,
  doctor_data$specialty == "Family Medicine" ~ 0,
  doctor_data$specialty == "Pediatrics" ~ -20000
)

experience_bonus <- doctor_data$years_experience * 5000
career_break_penalty <- doctor_data$career_breaks * -15000

doctor_data$salary <- base_salary + specialty_bonus + experience_bonus + career_break_penalty + stats::rnorm(n_doctors, 0, 20000)

# Overall comparison
overall_comparison <- doctor_data |>
  dplyr::group_by(gender) |>
  dplyr::summarise(
    Mean_Salary = base::round(base::mean(salary), 0),
    N = dplyr::n(),
    .groups = 'drop'
  ) |>
  dplyr::mutate(Analysis = "Overall Comparison")

# Comparable groups comparison
comparable_doctors <- doctor_data |>
  dplyr::filter(children == 0, career_breaks == 0, marital_status == "Single")

comparable_comparison <- comparable_doctors |>
  dplyr::group_by(gender) |>
  dplyr::summarise(
    Mean_Salary = base::round(base::mean(salary), 0),
    N = dplyr::n(),
    .groups = 'drop'
  ) |>
  dplyr::mutate(Analysis = "Comparable Groups (No children, No career breaks, Single)")

# Combine results
sowell_demo <- dplyr::bind_rows(overall_comparison, comparable_comparison)

DT::datatable(sowell_demo,
              caption = "The Thomas Sowell Principle: Disaggregate Until Comparable",
              options = list(dom = 't'),
              rownames = FALSE) |>
  DT::formatCurrency(columns = 'Mean_Salary', currency = "$", digits = 0)

# Visualization
p6 <- doctor_data |>
  dplyr::mutate(comparable_group = ifelse(children == 0 & career_breaks == 0 & marital_status == "Single", 
                                  "Comparable", "All Doctors")) |>
  dplyr::group_by(gender, comparable_group) |>
  dplyr::summarise(mean_salary = base::mean(salary), .groups = 'drop') |>
  ggplot2::ggplot(ggplot2::aes(x = comparable_group, y = mean_salary, fill = gender)) +
  ggplot2::geom_col(position = "dodge", alpha = 0.8) +
  ggplot2::scale_fill_manual(values = base::c("Male" = "#74C0FC", "Female" = "#FF6B6B")) +
  ggplot2::labs(title = "Doctor Salary 'Gap' Disappears When Comparing Comparable Groups",
       subtitle = "The Sowell Principle applied to gender pay differences",
       x = "Analysis Type",
       y = "Mean Salary",
       fill = "Gender") +
  ggplot2::scale_y_continuous(labels = scales::label_dollar())

base::print(p6)

```

**Result:** The "gender gap" disappears when comparing truly comparable individuals.

#### Applying This to Educational Research

**Instead of:**
- Comparing all Red students to all Blue students
- Comparing all Green students to all Blue students

**Scientific approach:**
- Compare high-SES Red students to high-SES Blue students
- Compare recent immigrant Blue students to recent immigrant Green students  
- Compare students with similar family structures across demographic groups
- Compare students with similar prior preparation across demographic groups

#### The Hidden Truth: Within-Group Variation

::: {.callout-note}
## Key Insight

High-performing Red, Green, Blue, and other students often have more in common with each other than with low-performing members of their own demographic group.
:::

```{r}
#| label: within-group-variation-demo

# Demonstrate clustering by performance rather than demographics
high_performers <- student_data |>
  dplyr::filter(test_score > stats::quantile(test_score, 0.8)) |>
  dplyr::group_by(demographic_group, ses_level, family_structure) |>
  dplyr::summarise(
    Mean_Score = base::round(base::mean(test_score), 0),
    N = dplyr::n(),
    .groups = 'drop'
  ) |>
  dplyr::arrange(base::c(Mean_Score))

DT::datatable(high_performers,
              caption = "High Performers: More Similarity Across Demographics Than Within",
              options = list(pageLength = 10),
              rownames = FALSE)

# Show correlation matrix
correlation_data <- student_data |>
  dplyr::select(test_score, ses_level, family_structure, parent_education, demographic_group) |>
  dplyr::mutate(
    ses_numeric = dplyr::case_when(ses_level == "High" ~ 3, ses_level == "Medium" ~ 2, ses_level == "Low" ~ 1),
    family_numeric = ifelse(family_structure == "Two-parent", 1, 0),
    education_numeric = dplyr::case_when(parent_education == "College+" ~ 3, 
                                 parent_education == "High School" ~ 2, 
                                 parent_education == "< High School" ~ 1),
    demo_red = ifelse(demographic_group == "Red", 1, 0),
    demo_green = ifelse(demographic_group == "Green", 1, 0),
    demo_blue = ifelse(demographic_group == "Blue", 1, 0)
  ) |>
  dplyr::select(test_score, ses_numeric, family_numeric, education_numeric, demo_red, demo_green, demo_blue)

cor_matrix <- stats::cor(correlation_data)
cor_with_scores <- cor_matrix[1, -1]

correlation_table <- base::data.frame(
  Variable = base::c("SES Level", "Two-parent Family", "Parent Education", "Red Group", "Green Group", "Blue Group"),
  Correlation_with_Test_Score = base::round(cor_with_scores, 3),
  Importance = base::c("High", "Medium", "High", "Low", "Low", "Low")
)

DT::datatable(correlation_table,
              caption = "What Actually Predicts Academic Success",
              options = list(dom = 't'),
              rownames = FALSE) |>
  DT::formatStyle("Importance", 
                  backgroundColor = DT::styleEqual(base::c("High", "Medium", "Low"), 
                                                   base::c("#90EE90", "#FFFF99", "#FFB6C1")))
```

**This suggests the real variables of interest are:**
- Family structure and stability
- Cultural attitudes toward education  
- Economic resources
- Prior educational preparation
- Peer influences

**NOT demographic categories themselves.**

## The Current Pseudo-Scientific Approach

Instead of proper methodology, current "equity research" follows this pattern:

```{r}
#| label: pseudo-science-steps

pseudo_science_steps <- base::data.frame(
  Step = 1:4,
  Current_Approach = base::c(
    "**Assume** group differences = discrimination",
    "**Collect data** confirming the assumption",
    "**Implement interventions** based on assumptions", 
    "**Declare success** regardless of actual results"
  ),
  Scientific_Approach = base::c(
    "**Test hypotheses** about possible causes",
    "**Control for confounds** and alternative explanations",
    "**Require evidence** before implementing interventions",
    "**Measure actual results** with proper controls"
  ),
  Validity = base::c("Invalid", "Invalid", "Invalid", "Invalid")
)

DT::datatable(pseudo_science_steps,
              caption = "Current vs. Scientific Approaches to Educational Equity",
              options = list(dom = 't', scrollX = TRUE),
              rownames = FALSE,
              escape = FALSE) |>
  DT::formatStyle("Validity", 
                  backgroundColor = DT::styleEqual("Invalid", "#FFB6C1"))
```

## Medical Research Analogy

Imagine if pharmaceutical companies could:

```{r}
#| label: pharma-analogy

pharma_analogy <- base::data.frame(
  Invalid_Practice = base::c(
    "Assume their drug works without testing",
    "Only test on people likely to improve anyway",
    "Ignore side effects",
    "Skip control groups",
    "Get FDA approval based on 'equity' rather than efficacy"
  ),
  Educational_Equivalent = base::c(
    "Assume interventions work without testing",
    "Only measure favorable results",
    "Ignore negative consequences for some students",
    "No comparison schools or baseline measurements",
    "Implement policies based on ideology rather than evidence"
  ),
  Consequence = base::c(
    "Ineffective or harmful treatments",
    "Biased and unreliable results",
    "Unrecognized harm to patients",
    "Cannot determine causation",
    "Public health catastrophe"
  )
)

DT::datatable(pharma_analogy,
              caption = "Medical Research Standards vs. Educational Equity Research",
              options = list(pageLength = 10, scrollX = TRUE),
              rownames = FALSE)
```

**Result:** Public health catastrophe

**Current Reality:** This is exactly the methodology being used to reshape education policy affecting millions of children.

## Practical Checklist for Researchers Using Government Datasets

### Before You Start Analysis

```{r}
#| label: researcher-checklist

checklist_before <- base::data.frame(
  Requirement = base::c(
    "Define hypotheses clearly",
    "Specify effect sizes", 
    "Identify confounds",
    "Plan rational subgrouping",
    "Plan sensitivity tests"
  ),
  Question_to_Ask = base::c(
    "What specific claims are you testing?",
    "How large a difference would be meaningful?",
    "What other variables could explain group differences?",
    "How will you ensure comparable groups?",
    "How will you check if results are robust?"
  ),
  Status = base::rep("Required", 5)
)

DT::datatable(checklist_before,
              caption = "Pre-Analysis Requirements",
              options = list(pageLength = 10, scrollX = TRUE),
              rownames = FALSE)
```

### During Analysis: Rational Subgrouping

```{r}
#| label: analysis-requirements

analysis_requirements <- base::data.frame(
  Check = base::c(
    "Test within-group homogeneity",
    "Compare matched subgroups", 
    "Analyze the most comparable individuals",
    "Report within-group vs. between-group variation"
  ),
  Method = base::c(
    "Levene's test, variance ratios",
    "Propensity score matching",
    "Subset to truly similar individuals",
    "Calculate ICC, variance decomposition"
  ),
  Interpretation = base::c(
    "If p<0.05, groups not homogeneous - comparison invalid",
    "Only compare students with similar characteristics",
    "Not entire demographic categories", 
    "Most variation should be between, not within groups"
  )
)

DT::datatable(analysis_requirements,
              caption = "Analysis Requirements for Valid Group Comparisons",
              options = list(pageLength = 10, scrollX = TRUE),
              rownames = FALSE)
```

### Standard Analysis Checks

- [ ] **Test multiple models** - Do results hold with different control variables?
- [ ] **Check category validity** - Are government categories internally consistent?
- [ ] **Report effect sizes** - Not just statistical significance
- [ ] **Show confidence intervals** - Acknowledge uncertainty

### Before Publishing/Recommending Policy

- [ ] **Apply the Thomas Sowell test** - Do gaps disappear when comparing truly similar individuals?
- [ ] **Consider alternative explanations** - What else could cause these patterns?
- [ ] **Test on holdout data** - Do results replicate on independent samples?
- [ ] **Discuss limitations honestly** - What can't your study tell us?
- [ ] **Avoid causal language** - Use "associated with" not "caused by"

### Red Flag Questions for Data Mining

```{r}
#| label: red-flags

red_flags <- base::data.frame(
  Question = base::c(
    "Did I decide what to look for before looking at the data?",
    "How many different analyses did I try before getting this result?",
    "Would I be willing to bet money that this result will replicate?",
    "Am I controlling for the most obvious alternative explanations?",
    "Am I comparing truly comparable individuals or just demographic categories?",
    "Is most of the variation within groups or between groups?"
  ),
  Good_Answer = base::c("Yes", "Just one", "Yes", "Yes", "Comparable individuals", "Between groups"),
  Warning_Sign = base::c("No", "Many", "No", "No", "Just demographics", "Within groups")
)

DT::datatable(red_flags,
              caption = "Red Flags for Data Mining vs. Hypothesis Testing",
              options = list(pageLength = 10, scrollX = TRUE),
              rownames = FALSE) |>
  DT::formatStyle("Warning_Sign", backgroundColor = "#FFB6C1") |>
  DT::formatStyle("Good_Answer", backgroundColor = "#90EE90")
```

If you can't answer these satisfactorily, you're probably data mining rather than hypothesis testing.

## Conclusions

The current approach to educational equity research violates fundamental principles of scientific investigation:

```{r}
#| label: violations-summary

violations <- base::data.frame(
  Violation = base::c(
    "No hypothesis testing of core assumptions",
    "No control for confounding variables", 
    "No proper control groups",
    "No accounting for natural variation",
    "No replication requirements",
    "Policy implementation without evidence",
    "No rational subgrouping"
  ),
  Consequence = base::c(
    "Unproven assumptions treated as fact",
    "Cannot distinguish correlation from causation",
    "Cannot establish causal relationships", 
    "Chasing statistical noise",
    "Unreliable and irreproducible results",
    "Harm to students from ineffective policies",
    "Comparing apples to oranges"
  ),
  Scientific_Standard = base::c(
    "Test competing hypotheses",
    "Control for alternative explanations",
    "Use matched comparison groups",
    "Calculate confidence intervals", 
    "Independent replication required",
    "Evidence required before implementation",
    "Disaggregate until comparable"
  )
)

DT::datatable(violations,
              caption = "Violations of Scientific Method in Current Equity Research",
              options = list(pageLength = 10, scrollX = TRUE),
              rownames = FALSE)
```

::: {.callout-note}
## The Thomas Sowell Principle

Whether examining educational results or medical doctor salaries, Sowell's analysis demonstrates that apparent group differences often disappear when comparing truly comparable individuals rather than broad demographic categories.

**Educational Example:** High-performing students of all demographic groups often have more in common with each other than with low-performing members of their own demographic group.

**Medical Example:** Never-married female doctors with no career breaks earn the same (or more) than comparable male doctors.
:::

**The Fundamental Question:** Are we measuring discrimination or are we measuring the effects of different life choices, preparation levels, and cultural factors that happen to correlate with demographic categories?

A genuinely scientific approach would dis-aggregate data until comparison groups are truly comparable, not stop at convenient government-defined (***political***) categories.
